"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[3704],{33704:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var l=a(99584),i=a(84616),n=a(23424),d=a(65236),s=a(84808),o=a(66296),r=a(87968),c=a(98044),u=a(87228),v=a(68496),h=a(15752),m=a(71836),x=a(36668),p=a(18896),g=a(32712),j=a(61072),y=a(46003),f=a(98016),w=a(53992),b=a(19576),k=a(68256),C=a(44512),_=a(61088),I=a(68660),P=a(83072),S=a.n(P),q=a(65732),M=a(95884),O=a(68768),T=a(10260),G=a(46712),Y=a(97884);function E(e){let{data:t,handleCancel:a,handleOk:i,visible:n}=e;const{t:s}=(0,d.G)(),[o]=q.c.useForm(),[r,c]=(0,l.useState)(!1);return(0,Y.jsx)(M.default,{title:s(t.title),visible:n,onCancel:a,footer:[(0,Y.jsx)(u.c,{type:"primary",onClick:()=>o.submit(),loading:r,children:s("save")}),(0,Y.jsx)(u.c,{type:"default",onClick:a,children:s("cancel")})],children:(0,Y.jsx)(q.c,{layout:"vertical",onFinish:e=>{c(!0);const t={...e,status:"canceled"};i(t)},form:o,children:(0,Y.jsx)(q.c.Item,{children:(0,Y.jsx)(O.c,{className:"mt-4",children:(0,Y.jsx)(T.c,{span:24,children:(0,Y.jsx)(q.c.Item,{name:"status_note",label:s("note"),rules:[{validator:(e,t)=>t?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(s("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(s("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(s("required")))}],children:(0,Y.jsx)(G.default.TextArea,{maxLength:250,showCount:!0})})})})})})})}const H={type:"category"};function K(e){var t,a,i;let{parentId:s,type:P="main"}=e;const{t:q}=(0,d.G)(),{setIsModalVisible:M}=(0,l.useContext)(f.e),[O,T]=(0,l.useState)(!1),[G,K]=(0,l.useState)(!1),[N,Q]=(0,l.useState)(null),z=(0,g.OY)(),A=(0,n.i6)(),{activeMenu:B}=(0,g.w1)((e=>e.menu),g.G),{data:D,meta:F,loading:W,params:L}=(0,g.w1)((e=>e.requestModels),g.G),R=B.data,{uuid:U}=(0,n.W4)(),V={search:null===R||void 0===R?void 0:R.search,sort:null===R||void 0===R?void 0:R.sort,column:null===R||void 0===R?void 0:R.column,perPage:null===R||void 0===R?void 0:R.perPage,page:null===R||void 0===R?void 0:R.page,parent_id:s},[J,X]=(0,l.useState)([{title:q("created.by"),dataIndex:"createdBy",key:"createdBy",is_show:!0,render:e=>(0,Y.jsxs)("span",{children:[e.firstname," ",null===e||void 0===e?void 0:e.lastname," ",(0,Y.jsx)("a",{href:"tel:".concat(null===e||void 0===e?void 0:e.phone),children:null===e||void 0===e?void 0:e.phone})]})},{title:q("created.at"),dataIndex:"created_at",key:"created_at",is_show:!0,render:e=>S()(e).format("YYYY-MM-DD HH:mm")},{title:q("name"),dataIndex:"name",key:"name",is_show:!0,render:(e,t)=>{var a,l,i,n,d,s;return(0,Y.jsxs)(o.c,{children:[null===t||void 0===t||null===(a=t.model)||void 0===a||null===(l=a.translation)||void 0===l?void 0:l.title," ",(0,Y.jsx)(_.Ogl,{})," ",null===t||void 0===t||null===(i=t.data)||void 0===i||null===(n=i.title)||void 0===n?void 0:n[null===t||void 0===t||null===(d=t.model)||void 0===d||null===(s=d.translation)||void 0===s?void 0:s.locale]]})}},{title:q("image"),dataIndex:"img",key:"img",is_show:!0,render:(e,t)=>{var a,l,i;return(0,Y.jsxs)(o.c,{children:[(0,Y.jsx)(r.c,{src:(0,m.c)(null===t||void 0===t||null===(a=t.model)||void 0===a?void 0:a.img),alt:"img_gallery",width:100,className:"rounded",preview:!0,placeholder:!0}),(0,Y.jsx)(_.Ogl,{}),(0,Y.jsx)(r.c,{src:(0,m.c)(null===t||void 0===t||null===(l=t.data)||void 0===l||null===(i=l.images)||void 0===i?void 0:i.at(0)),alt:"img_gallery",width:100,className:"rounded",preview:!0,placeholder:!0})]})}},{title:q("status"),is_show:!0,dataIndex:"status",key:"status",render:(e,t)=>(0,Y.jsx)("div",{children:"pending"===e?(0,Y.jsx)(c.c,{color:"blue",children:q(e)}):"canceled"===e?(0,Y.jsx)(c.c,{color:"error",children:q(e)}):(0,Y.jsx)(c.c,{color:"cyan",children:q(e)})})},{title:q("options"),key:"options",dataIndex:"options",is_show:!0,render:(e,t)=>(0,Y.jsxs)(o.c,{children:[(0,Y.jsx)(u.c,{icon:(0,Y.jsx)(x.c,{}),onClick:()=>(e=>{z((0,p.WC)({url:"category-request/".concat(e.id),id:"request_edit",name:q("request.edit")})),A("/category-request/".concat(e.id),{state:{parentId:s,parentUuid:U}})})(t)}),(0,Y.jsx)(u.c,{type:"primary",onClick:()=>{Q([{id:t.id,status:"approved"}]),M(!0)},children:q("accept")}),(0,Y.jsx)(u.c,{type:"primary",danger:!0,onClick:()=>{Q([{id:t.id,status:"canceled"}]),T(!0)},children:q("decline")})]})}]);(0,l.useEffect)((()=>{z((0,C.eQ)(V)),z((0,p.CO)(B))}),[B.refetch]),(0,k.c)((()=>{z((0,C.eQ)(V))}),[B.data]);const Z=e=>{K(!0);const t={status:null===N||void 0===N?void 0:N.at(0).status,status_note:null===e||void 0===e?void 0:e.status_note};I.c.changeStatus(null===N||void 0===N?void 0:N.at(0).id,t).then((()=>{j.m4.success(q("successfully.changed")),z((0,C.eQ)(H)),M(!1),Q(null)})).finally((()=>{T(!1),K(!1)}))},$={selectedRowKeys:N,onChange:e=>{Q(e)}};return(0,Y.jsxs)(v.default,{title:q("requests"),extra:(0,Y.jsx)(o.c,{wrap:!0,children:(0,Y.jsx)(w.c,{columns:J,setColumns:X})}),children:[(0,Y.jsx)(h.c,{scroll:{x:!0},rowSelection:$,columns:null===J||void 0===J?void 0:J.filter((e=>e.is_show)),dataSource:D,pagination:{pageSize:L.perPage,page:(null===(t=B.data)||void 0===t?void 0:t.page)||1,total:F.total,defaultCurrent:null===(a=B.data)||void 0===a?void 0:a.page,current:null===(i=B.data)||void 0===i?void 0:i.page},rowKey:e=>e.key,onChange:function(e,t,a){const{pageSize:l,current:i}=e,{field:n,order:d}=a,s=(0,b.c)(d);z((0,p.MH)({activeMenu:B,data:{...B.data,perPage:l,page:i,column:n,sort:s}}))},loading:W}),(0,Y.jsx)(y.c,{click:Z,text:q("change.status"),setText:Q,loading:G}),(0,Y.jsx)(E,{data:{title:"decline"},visible:O,handleCancel:()=>T(!1),handleOk:Z,laoding:G})]})}function N(){var e;const{t:t}=(0,d.G)(),a=(0,n.IT)();return(0,Y.jsxs)(i.default,{defaultActiveKey:(null===(e=a.state)||void 0===e?void 0:e.tab)||"list",destroyInactiveTabPane:!0,children:[(0,Y.jsx)(i.default.TabPane,{tab:t("category.list"),children:(0,Y.jsx)(s.c,{})},"list"),(0,Y.jsx)(i.default.TabPane,{tab:t("requests"),children:(0,Y.jsx)(K,{})},"request")]})}}}]);