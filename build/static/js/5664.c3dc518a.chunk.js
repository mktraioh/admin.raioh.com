"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[5664],{24692:(e,t,s)=>{s.d(t,{o:()=>u});var a=s(99584),n=s(2664),l=s(37728),i=s(97884);const u=e=>{let{fetchOptions:t,refetch:s=!1,...u}=e;const[d,c]=(0,a.useState)(!1),[o,r]=(0,a.useState)([]);return(0,i.jsx)(n.default,{labelInValue:!0,filterOption:!1,notFoundContent:d?(0,i.jsx)(l.c,{size:"small"}):"no results",...u,options:d?[]:o,onFocus:()=>{o.length&&!s||(c(!0),t().then((e=>{r(e),c(!1)})))}})}},45664:(e,t,s)=>{s.r(t),s.d(t,{default:()=>f});var a=s(99584),n=s(23424),l=s(61072),i=s(65732),u=s(68496),d=s(32712),c=s(18896),o=s(65236),r=s(83072),b=s.n(r),m=s(41232),x=s(96156),p=s(77180),h=s(89140),v=s(97884);const f=()=>{const{t:e}=(0,o.G)(),{activeMenu:t}=(0,d.w1)((e=>e.menu),d.G),s=(0,d.OY)(),[r]=i.c.useForm(),f=(0,n.i6)(),[j,_]=(0,a.useState)(!1),{id:y}=(0,n.W4)();(0,a.useEffect)((()=>()=>{const e=r.getFieldsValue(!0),a={...e,expired_at:JSON.stringify(null===e||void 0===e?void 0:e.expired_at)};s((0,c.MH)({activeMenu:t,data:a}))}),[]);const g=e=>{_(!0),x.c.getById(e).then((e=>{!function(e){var a,n,l,i,u,d;const o={...e,expired_at:b()(e.expired_at,"YYYY-MM-DD"),bonusable_id:{label:(null===e||void 0===e||null===(a=e.bonusable)||void 0===a?void 0:a.product.translation.title)+" "+(null===(n=e.bonusable)||void 0===n?void 0:n.extras.map((e=>e.value)).join(", ")),value:null===(l=e.bonusable)||void 0===l?void 0:l.id},bonus_stock_id:{label:(null===e||void 0===e||null===(i=e.bonusStock)||void 0===i?void 0:i.product.translation.title)+" "+(null===(u=e.bonusStock)||void 0===u?void 0:u.extras.map((e=>e.value)).join(", ")),value:null===e||void 0===e||null===(d=e.bonusStock)||void 0===d?void 0:d.id}};r.setFieldsValue({...o}),s((0,c.MH)({activeMenu:t,data:{...o,expired_at:JSON.stringify(o.expired_at)}})),_(!1)}(e.data)})).finally((()=>{_(!1),s((0,c.CO)(t))}))};(0,a.useEffect)((()=>{t.refetch&&g(y)}),[t.refetch]);return(0,v.jsx)(u.default,{title:e("edit.bonus"),className:"h-100",children:j?(0,v.jsx)(p.c,{}):(0,v.jsx)(h.c,{form:r,handleSubmit:a=>{const n={expired_at:b()(a.expired_at).format("YYYY-MM-DD"),status:a.status,type:"count",bonusable_id:a.bonusable_id.value,value:a.value,bonus_stock_id:a.bonus_stock_id.value,bonus_quantity:a.bonus_quantity},i="seller/bonus/product";x.c.update(y,n).then((()=>{l.m4.success(e("successfully.updated")),(0,d.wN)((()=>{s((0,c.MF)({...t,nextUrl:i})),s((0,m.M)({}))})),f("/".concat(i))}))}})})}},89140:(e,t,s)=>{s.d(t,{c:()=>f});var a=s(99584),n=s(65732),l=s(68768),i=s(10260),u=s(10240),d=s(73568),c=s(26012),o=s(87228),r=s(24692),b=s(83072),m=s.n(b),x=s(65236),p=s(32712),h=s(31e3),v=s(97884);function f(e){let{form:t,handleSubmit:s}=e;const{t:b}=(0,x.G)(),{activeMenu:f}=(0,p.w1)((e=>e.menu),p.G),[j,_]=(0,a.useState)(!1);function y(){return h.c.getStock().then((e=>e.data.map((e=>({label:e.product.translation.title+"".concat(e.extras.length>0?": ".concat(e.extras.map((e=>e.value)).join(", ")):""),value:e.id,key:e.id})))))}return(0,v.jsxs)(n.c,{name:"product-bonus-form",layout:"vertical",onFinish:e=>{_(!0),s(e).finally((()=>_(!1)))},form:t,initialValues:{status:!0,...f.data,...(()=>{var e,t;if(null===(e=f.data)||void 0===e||!e.expired_at)return{};const s=JSON.parse(null===(t=f.data)||void 0===t?void 0:t.expired_at);return{expired_at:m()(s,"HH:mm:ss")}})()},className:"d-flex flex-column h-100",children:[(0,v.jsxs)(l.c,{gutter:12,children:[(0,v.jsx)(i.c,{span:12,children:(0,v.jsx)(n.c.Item,{label:b("products.stock"),name:"bonusable_id",rules:[{required:!0,message:b("required")}],children:(0,v.jsx)(r.o,{fetchOptions:y,debounceTimeout:200})})}),(0,v.jsx)(i.c,{span:12,children:(0,v.jsx)(n.c.Item,{label:b("product.quantity"),name:"value",rules:[{required:!0,message:b("required")}],children:(0,v.jsx)(u.c,{className:"w-100"})})}),(0,v.jsx)(i.c,{span:12,children:(0,v.jsx)(n.c.Item,{label:b("bonus.product.stock"),name:"bonus_stock_id",rules:[{required:!0,message:b("required")}],children:(0,v.jsx)(r.o,{fetchOptions:y,debounceTimeout:200})})}),(0,v.jsx)(i.c,{span:12,children:(0,v.jsx)(n.c.Item,{label:b("bonus.product.quantity"),name:"bonus_quantity",rules:[{required:!0,message:b("required")}],children:(0,v.jsx)(u.c,{className:"w-100"})})}),(0,v.jsx)(i.c,{span:12,children:(0,v.jsx)(n.c.Item,{name:"expired_at",label:b("expired.at"),rules:[{required:!0,message:b("required")}],children:(0,v.jsx)(d.default,{className:"w-100",placeholder:"",disabledDate:e=>m()().add(-1,"days")>=e})})}),(0,v.jsx)(i.c,{span:8,children:(0,v.jsx)(n.c.Item,{label:b("active"),name:"status",valuePropName:"checked",children:(0,v.jsx)(c.c,{})})})]}),(0,v.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,v.jsx)("div",{className:"pb-5",children:(0,v.jsx)(o.c,{type:"primary",htmlType:"submit",loading:j,children:b("submit")})})})]})}}}]);