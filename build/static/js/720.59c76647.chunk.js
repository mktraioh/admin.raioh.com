"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[720],{10920:(e,l,n)=>{n.d(l,{I:()=>r});var i=n(99584),a=n(95976),t=n.n(a),s=n(2664),d=n(37728),o=n(97884);const r=e=>{let{fetchOptions:l,debounceTimeout:n=400,hasMore:a,...r}=e;const[c,u]=(0,i.useState)(!1),[v,p]=(0,i.useState)([]),[h,m]=(0,i.useState)(!1),[x,y]=(0,i.useState)(null),[j,g]=(0,i.useState)(1),f=(0,i.useMemo)((()=>t()((e=>{p([]),y(e),u(!0),l({search:e}).then((e=>{p(e),g(2),u(!1)})).finally((()=>m(!1)))}),n)),[l,n,j]);return(0,o.jsxs)(s.default,{showSearch:!0,allowClear:!0,onPopupScroll:async e=>{const n=e.target;h||n.scrollTop+n.offsetHeight!==n.scrollHeight||a&&(m(!0),n.scrollTo(0,n.scrollHeight),l({search:x,page:j}).then((e=>{g((e=>e+1)),p([...v,...e])})).finally((()=>m(!1))))},labelInValue:!0,filterOption:!1,onSearch:f,notFoundContent:c?(0,o.jsx)(d.c,{size:"small"}):"no results",onFocus:()=>{v.length||f("")},...r,children:[v.map(((e,l)=>(0,o.jsx)(s.default.Option,{value:e.value,children:e.label},l))),h&&(0,o.jsx)(s.default.Option,{children:(0,o.jsx)(d.c,{size:"small"})})]})}},33424:(e,l,n)=>{n.d(l,{c:()=>s});var i=n(71760),a=n.n(i),t=n(52640);async function s(e){let l={address:e,key:arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.KU};return a().get("https://maps.googleapis.com/maps/api/geocode/json",{params:l}).then((e=>{let{data:l}=e;return l.results[0]})).catch((e=>"not found"))}},54572:(e,l,n)=>{n.d(l,{c:()=>a});var i=n(99584);function a(e,l){const[n,a]=(0,i.useState)(e);return(0,i.useEffect)((()=>{const n=setTimeout((()=>{a(e)}),l);return()=>{clearTimeout(n)}}),[e,l]),n}},33552:(e,l,n)=>{function i(e){return e.cartItems.filter((l=>l.bag_id===e.currentBag))}function a(e){return e.data.find((l=>l.bag_id===e.currentBag))}n.d(l,{KG:()=>a,QX:()=>i})},65304:(e,l,n)=>{n.r(l),n.d(l,{default:()=>qe});var i=n(99584),a=n(68496),t=n(68768),s=n(10260),d=n(1284),o=n(12636),r=n(75808),c=n(68256),u=n(32712),v=n(63616),p=n(40748),h=n(65236),m=n(99649),x=n(99924),y=n(18896),j=n(33552),g=n(47148),f=n(10920),_=n(97884);const b=()=>{const{t:e}=(0,h.G)(),l=(0,u.OY)(),[n,b]=(0,i.useState)(null),[S,w]=(0,i.useState)(null),[k,N]=(0,i.useState)(null),{activeMenu:q}=(0,u.w1)((e=>e.menu),u.G),{allShops:C}=(0,u.w1)((e=>e.allShops),u.G),{currentBag:I}=(0,u.w1)((e=>e.cart),u.G),G=function(e){var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id}}(C[0]),D=(0,u.w1)((e=>(0,j.KG)(e.cart))),[M,P]=(0,i.useState)(null);(0,c.c)((()=>{var e,i;const a={brand_id:null===n||void 0===n?void 0:n.value,category_id:null===S||void 0===S?void 0:S.value,search:k,shop_id:null===D||void 0===D||null===(e=D.shop)||void 0===e?void 0:e.value,status:"published"};l((0,v.yK)(a)),null!==D&&void 0!==D&&null!==(i=D.shop)&&void 0!==i&&i.value&&async function(){const e=null===D||void 0===D?void 0:D.shop.value;g.c.getById(e).then((e=>{l((0,m.SS)({bag_id:I,payment_type:e.data.map((e=>e.payment))}))}))}()}),[n,S,k,D.shop]);return(0,i.useEffect)((()=>{const e={shop_id:null===G||void 0===G?void 0:G.value};q.refetch&&(l((0,x.Sq)(e)),l((0,m.SS)({bag_id:I,shop:G})),l((0,y.CO)(q)))}),[q.refetch]),(0,_.jsx)(a.default,{children:(0,_.jsxs)(t.c,{gutter:12,children:[(0,_.jsx)(s.c,{span:6,children:(0,_.jsx)(p.c,{className:"w-100",placeholder:e("search"),handleChange:N})}),(0,_.jsx)(s.c,{span:6,children:(0,_.jsx)(f.I,{className:"w-100",hasMore:null===M||void 0===M?void 0:M.next,debounceTimeout:500,placeholder:e("select.shop"),fetchOptions:async function(e){let{search:l,page:n}=e;const i={search:l,page:n,status:"approved"};return d.c.search(i).then((e=>(P(e.links),e.data.map((e=>({label:null!==e.translation?e.translation.title:"no name",value:e.id}))))))},allowClear:!1,onChange:e=>{l((0,m.SS)({bag_id:I,shop:e})),l((0,m.am)())},value:null===D||void 0===D?void 0:D.shop})}),(0,_.jsx)(s.c,{span:6,children:(0,_.jsx)(f.I,{className:"w-100",hasMore:null===M||void 0===M?void 0:M.next,placeholder:e("select.category"),fetchOptions:async function(e){let{search:l,page:n}=e;const i={search:l,page:n,type:"main"};return r.c.search(i).then((e=>(P(e.links),e.data.map((e=>({label:null!==e.translation?e.translation.title:"no name",value:e.id}))))))},onChange:e=>w(e),value:S})}),(0,_.jsx)(s.c,{span:6,children:(0,_.jsx)(f.I,{hasMore:null===M||void 0===M?void 0:M.next,className:"w-100",placeholder:e("select.brand"),fetchOptions:async function(e){let{search:l,page:n=1}=e;const i={search:l,page:n};return o.c.search(i).then((e=>(P(e.links),e.data.map((e=>({label:e.title,value:e.id}))))))},onChange:e=>b(e),value:n})})]})})};var S=n(88560),w=n(37728),k=n(77748),N=n(75216),q=n(94936),C=n(71836),I=n(61072),G=n(95884),D=n(87228),M=n(87968),P=n(37564),E=n(66296),O=n(3952),B=n(59956),Y=n(24968),F=n(71976),V=n(66684),H=n(21712),K=n(59528);const z=e=>{var l,n;let{showExtras:i,addonCalculate:a,selectedValues:t,handleChange:s}=e;return(0,_.jsx)(E.c,{direction:"vertical",size:"middle",children:null===(l=i.stock)||void 0===l||null===(n=l.addons)||void 0===n?void 0:n.filter((e=>!!e.product)).map((e=>{const l=t.includes(String(e.addon_id));return(0,_.jsxs)("div",{children:[(0,_.jsx)(K.c,{id:String(e.id),name:String(e.id),checked:l,onChange:()=>s(e)}),(0,_.jsxs)("label",{htmlFor:String(e.id),children:[l&&(0,_.jsxs)(E.c,{size:0,children:[(0,_.jsx)(D.c,{type:"text",className:"minus-button",style:{padding:0,height:"max-content"},size:"small",icon:(0,_.jsx)(B.c,{}),disabled:1===e.product.quantity,onClick:l=>{l.stopPropagation(),a(e.addon_id,e.product.quantity-1)}}),(0,_.jsx)("span",{className:"ml-2",children:e.product.quantity||e.product.min_qty}),(0,_.jsx)(D.c,{type:"text",className:"plus-button",style:{padding:0,height:"max-content"},size:"small",icon:(0,_.jsx)(q.c,{}),onClick:l=>{l.stopPropagation(),a(e.addon_id,e.product.quantity?e.product.quantity+1:e.product.min_qty+1)}})]}),(0,_.jsx)("span",{className:"ml-2",children:e.product.translation.title})]})]},e.id)}))})};var T=n(10580);function A(e){var l,n,a,d;let{extrasModal:o,setExtrasModal:r}=e;const[v,p]=(0,i.useState)(!1),[x,y]=(0,i.useState)({}),{t:j}=(0,h.G)(),[g,f]=(0,i.useState)({}),b=(0,u.OY)(),[S,k]=(0,i.useState)([]),[N,K]=(0,i.useState)([]),[A,U]=(0,i.useState)([]),[J,L]=(0,i.useState)([]),[Q,X]=(0,i.useState)([]),[W,Z]=(0,i.useState)({extras:[],stock:{id:0,quantity:1,price:0}}),[R,$]=(0,i.useState)(o.quantity||x.quantity||x.min_qty),{currentBag:ee,currency:le}=(0,u.w1)((e=>e.cart),u.G);const ne=()=>r(!1);function ie(e){return(null===J||void 0===J?void 0:J.reduce(((e,l)=>e+l.product.stock.price*(l.product.quantity||l.product.min_qty)),0))+(null===W||void 0===W?void 0:W.stock)?null===W||void 0===W?void 0:W.stock[e||"price"]:0*R}return(0,c.c)((()=>{const e=W.stock.addons.filter((e=>Q.includes(String(e.addon_id))));L(e)}),[Q]),(0,i.useEffect)((()=>{null!==W&&void 0!==W&&W.stock&&f({...W.stock,extras:A})}),[W]),(0,i.useEffect)((()=>{p(!0),T.c.getById(o.uuid).then((e=>{var l;let{data:n}=e;y(n);const i=(0,H.Y)(n,null===o||void 0===o?void 0:o.addons);var a;(k(i.extras),$(o.quantity||n.quantity||n.min_qty),K(i.stock),Z((0,H.M)(A,i.extras,i.stock)),null===(l=(0,H.M)("",i.extras,i.stock).extras)||void 0===l||l.forEach((e=>{U((l=>[...l,e[0]]))})),null!==o&&void 0!==o&&o.addons)&&X((null===o||void 0===o||null===(a=o.addons)||void 0===a?void 0:a.map((e=>{var l;return String((null===e||void 0===e||null===(l=e.countable)||void 0===l?void 0:l.id)||e.countable_id)})))||[])})).finally((()=>p(!1)))}),[o.uuid]),(0,_.jsx)(G.default,{visible:!!x,title:x.name,onCancel:ne,footer:[v?null:(0,_.jsx)(D.c,{icon:(0,_.jsx)(O.c,{}),type:"primary",onClick:()=>{const e=J.map((e=>({...e,stockID:e.product.stock.id,quantity:e.product.quantity||e.product.min_qty}))),l={...x,stock:g,quantity:R,id:g.id,img:(0,V.c)(g)||x.img,bag_id:ee,stockID:g,addons:e};l.quantity>g.quantity?I.m4.warning("".concat(j("you.cannot.order.more.than")," ").concat(g.quantity)):(b((0,m.iA)(l)),r(null))},children:j("add")},"add-product"),(0,_.jsx)(D.c,{type:"default",onClick:ne,children:j("cancel")},"cancel-product")],children:(0,_.jsxs)(w.c,{spinning:v,children:[(0,_.jsxs)(t.c,{gutter:24,children:[(0,_.jsx)(s.c,{span:8,children:(0,_.jsx)(M.c,{src:(0,C.c)((0,V.c)(g)||x.img),alt:x.name,height:200,style:{objectFit:"contain"}})}),(0,_.jsx)(s.c,{span:16,children:(0,_.jsxs)(P.c,{title:null===(l=x.translation)||void 0===l?void 0:l.title,children:[(0,_.jsxs)(P.c.Item,{label:j("price"),span:3,children:[(0,_.jsx)("div",{className:null!==g&&void 0!==g&&g.discount?"strike":"",children:(0,Y.c)(ie(),null===le||void 0===le?void 0:le.symbol)}),null!==g&&void 0!==g&&g.discount?(0,_.jsx)("div",{className:"ml-2 font-weight-bold",children:(0,Y.c)(ie("total_price"),null===le||void 0===le?void 0:le.symbol)}):""]}),(0,_.jsx)(P.c.Item,{label:j("in.stock"),span:3,children:(0,F.c)(null===g||void 0===g?void 0:g.quantity,x.unit)}),(0,_.jsx)(P.c.Item,{label:j("tax"),span:3,children:(0,Y.c)(null===g||void 0===g?void 0:g.tax,null===le||void 0===le?void 0:le.symbol)})]})})]}),null===W||void 0===W||null===(n=W.extras)||void 0===n?void 0:n.map(((e,l)=>(0,_.jsx)("div",{className:"extra-group",children:(0,_.jsx)(E.c,{className:"extras-select",children:e.map((e=>(0,_.jsx)("span",{className:"extras-text rounded ".concat(A.find((l=>l.id===e.id))?"selected":""),onClick:()=>(e=>{var l;const n=A.findIndex((l=>l.extra_group_id===e.extra_group_id));let i=A;n>-1&&(i=i.slice(0,n)),i.push(e);const a=i.map((e=>e.id)).join(",");var t=(0,H.M)(a,S,N);Z(t),null===(l=t.extras)||void 0===l||l.forEach((l=>{const n=A.findIndex((n=>l[0].extra_group_id!=e.extra_group_id?n.extra_group_id===l[0].extra_group_id:n.extra_group_id===e.extra_group_id));if(l[0].level>=e.level){var a=l[0].extra_group_id!=e.extra_group_id?l[0]:e;-1==n?i.push(a):i[n]=a}})),U(i)})(e),children:e.value})))},"extra-group"+l)}))),(0,_.jsx)(z,{showExtras:W,selectedValues:Q,handleChange:e=>{const l=String(e.addon_id);Q.includes(l)?X((e=>e.filter((e=>e!==l)))):X((e=>[...e,l]))},addonCalculate:function(e,l){Z((n=>({...n,stock:{...n.stock,addons:n.stock.addons.map((n=>n.addon_id===e?{...n,product:{...n.product,quantity:l}}:n))}}))),L((n=>n.map((n=>n.addon_id===e?{...n,product:{...n.product,quantity:l}}:n))))}}),(0,_.jsx)(t.c,{gutter:12,className:"mt-3",children:(0,_.jsx)(s.c,{span:24,children:(0,_.jsxs)(E.c,{children:[(0,_.jsx)(D.c,{type:"primary",icon:(0,_.jsx)(B.c,{}),onClick:function(){1!==R&&(R<=x.min_qty||$((e=>e-1)))}}),(R||1)*((null===x||void 0===x?void 0:x.interval)||1),null===x||void 0===x||null===(a=x.unit)||void 0===a||null===(d=a.translation)||void 0===d?void 0:d.title,(0,_.jsx)(D.c,{type:"primary",icon:(0,_.jsx)(q.c,{}),onClick:function(){R!==(null===x||void 0===x?void 0:x.quantity)&&R!==x.max_qty&&$((e=>e+1))}})]})})})]})})}var U=n(5008),J=n(66596);function L(){const e={lg:8,xl:6,xxl:6},{t:l}=(0,h.G)(),[n,d]=(0,i.useState)(null),o=(0,u.OY)(),{products:r,loading:c,meta:p,params:m}=(0,u.w1)((e=>e.product),u.G),{data:x}=(0,u.w1)((e=>e.cart),u.G),y=(0,u.w1)((e=>(0,j.KG)(e.cart))),{currency:g}=(0,u.w1)((e=>e.cart),u.G),{before_order_phone_required:f}=(0,u.w1)((e=>e.globalSettings.settings),u.G);return(0,_.jsxs)("div",{className:"px-2",children:[c?(0,_.jsx)(w.c,{className:"d-flex justify-content-center my-5"}):(0,_.jsx)(t.c,{gutter:12,className:"mt-4 product-card",children:0===r.length?(0,_.jsx)(s.c,{span:24,children:(0,_.jsx)(J.c,{id:"nosell"})}):r.map(((n,t)=>{var o;return(0,i.createElement)(s.c,{...e,key:t},(0,_.jsxs)(a.default,{className:"products-col",cover:(0,_.jsx)("img",{alt:n.name,src:(0,C.c)(n.img)}),onClick:()=>(e=>{var n;g?0!==(null===y||void 0===y||null===(n=y.user)||void 0===n?void 0:n.length)?null!==y&&void 0!==y&&y.phone||"1"!==f?Number(null===y||void 0===y?void 0:y.phone)<0?I.m4.warning(l("invalid.phone.number")):y.address?null!==y&&void 0!==y&&y.paymentType?y.deliveries?null!==y&&void 0!==y&&y.delivery_date?null!==(null===y||void 0===y?void 0:y.delivery_time)?d(e):I.m4.warning(l("please.select.delivery.time")):I.m4.warning(l("please.select.delivery.date")):I.m4.warning(l("please.select.delivery")):I.m4.warning(l("please.select.payment.type")):I.m4.warning(l("please.select.address")):I.m4.warning(l("please.enter.phone")):I.m4.warning(l("please.select.user")):I.m4.warning(l("please.select.currency"))})(n),children:[(0,_.jsx)(N.c,{title:null===n||void 0===n||null===(o=n.translation)||void 0===o?void 0:o.title}),(0,_.jsx)("div",{className:"preview",children:(0,_.jsx)(q.c,{})}),n.stocks.map((e=>{var l,n;return(0,_.jsxs)("span",{className:e.bonus?"show-bonus":"d-none",children:[(0,_.jsx)(U.yEO,{})," ",null===(l=e.bonus)||void 0===l?void 0:l.value,"+",null===(n=e.bonus)||void 0===n?void 0:n.bonus_quantity]})}))]},n.id))}))}),n&&(0,_.jsx)(A,{extrasModal:n,setExtrasModal:d}),(0,_.jsx)("div",{className:"d-flex justify-content-end my-5",children:(0,_.jsx)(k.c,{total:p.total,current:m.page,pageSize:12,showSizeChanger:!1,onChange:function(e){o((0,v.yK)({perPage:12,page:e,shop_id:x[0].shop.value,status:"published",active:1}))},active:1})})]})}var Q=n(65732),X=n(10240),W=n(46712),Z=n(2664),R=n(4736),$=n(69116),ee=n(34116),le=n(42080),ne=n(78816);function ie(e){let{visible:l,handleCancel:n}=e;const{t:a}=(0,h.G)(),[d]=Q.c.useForm(),[o,r]=(0,i.useState)(!1),[c,u]=(0,i.useState)(null);return(0,_.jsx)(G.default,{title:a("add.client"),visible:l,onCancel:n,footer:[(0,_.jsx)(D.c,{type:"primary",onClick:()=>d.submit(),loading:o,children:a("save")},"ok-button"),(0,_.jsx)(D.c,{onClick:n,children:a("cancel")},"cancel-button")],children:(0,_.jsx)(Q.c,{layout:"vertical",name:"user-add-form",form:d,onFinish:e=>{const l={...e,role:"user"};r(!0),le.c.create(l).then((()=>{I.m4.success(a("successfully.added")),n()})).catch((e=>u(e.response.data.params))).finally((()=>r(!1)))},children:(0,_.jsxs)(t.c,{gutter:12,children:[(0,_.jsx)(s.c,{span:12,children:(0,_.jsx)(Q.c.Item,{label:a("firstname"),name:"firstname",help:null!==c&&void 0!==c&&c.firstname?c.firstname[0]:null,validateStatus:null!==c&&void 0!==c&&c.firstname?"error":"success",rules:[{validator:(e,l)=>l?l&&""===(null===l||void 0===l?void 0:l.trim())?Promise.reject(new Error(a("no.empty.space"))):l&&(null===l||void 0===l?void 0:l.trim().length)<2?Promise.reject(new Error(a("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(a("required")))}],children:(0,_.jsx)(W.default,{})})}),(0,_.jsx)(s.c,{span:12,children:(0,_.jsx)(Q.c.Item,{label:a("lastname"),name:"lastname",help:null!==c&&void 0!==c&&c.lastname?c.lastname[0]:null,validateStatus:null!==c&&void 0!==c&&c.lastname?"error":"success",rules:[{validator:(e,l)=>l?l&&""===(null===l||void 0===l?void 0:l.trim())?Promise.reject(new Error(a("no.empty.space"))):l&&(null===l||void 0===l?void 0:l.trim().length)<2?Promise.reject(new Error(a("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(a("required")))}],children:(0,_.jsx)(W.default,{})})}),(0,_.jsx)(s.c,{span:12,children:(0,_.jsx)(Q.c.Item,{label:a("phone"),name:"phone",help:null!==c&&void 0!==c&&c.phone?c.phone[0]:null,validateStatus:null!==c&&void 0!==c&&c.phone?"error":"success",rules:[{required:!0,message:a("required")}],children:(0,_.jsx)(X.c,{min:0,className:"w-100"})})}),(0,_.jsx)(s.c,{span:12,children:(0,_.jsx)(Q.c.Item,{label:a("email"),name:"email",help:null!==c&&void 0!==c&&c.email?c.email[0]:null,validateStatus:null!==c&&void 0!==c&&c.email?"error":"success",rules:[{required:!0,message:a("required")},{type:"email",message:a("invalid.email")}],children:(0,_.jsx)(W.default,{type:"email"})})})]})})})}var ae=n(89896),te=n(33131),se=n(55309),de=n(33424),oe=n(52640);function re(e){let{uuid:l,handleCancel:n}=e;const{t:a}=(0,h.G)(),[t]=Q.c.useForm(),s=(0,u.OY)(),d=(0,u.w1)((e=>(0,j.KG)(e.cart))),{currentBag:o}=(0,u.w1)((e=>e.cart),u.G),{settings:r}=(0,u.w1)((e=>e.globalSettings),u.G),[c,v]=(0,i.useState)(d.address?{lat:d.address.lat,lng:d.address.lng}:(0,te.c)(r)),[p,x]=(0,i.useState)(""),{placePredictions:y,getPlacePredictions:g,isPlacePredictionsLoading:f}=(0,se.c)({apiKey:oe.KU,libraries:["places","geocode"]});return(0,i.useEffect)((()=>{t.setFieldsValue({address:d.address.address||null})}),[o]),(0,_.jsx)(G.default,{visible:!!l,title:a("create.address"),onCancel:n,footer:[(0,_.jsx)(D.c,{type:"primary",onClick:()=>t.submit(),children:a("save")},"saveBtn"),(0,_.jsx)(D.c,{type:"default",onClick:n,children:a("cancel")},"cancelBtn")],children:(0,_.jsxs)(Q.c,{layout:"vertical",name:"user-address",form:t,onFinish:e=>{const l={...e,active:1,lat:c.lat,lng:c.lng};s((0,m.SS)({address:l,bag_id:o})),n()},children:[(0,_.jsx)(Q.c.Item,{name:"address",label:a("address"),rules:[{required:!0,message:a("required")}],children:(0,_.jsx)(Z.default,{allowClear:!0,searchValue:p,showSearch:!0,autoClearSearchValue:!0,loading:f,options:null===y||void 0===y?void 0:y.map((e=>({label:e.description,value:e.description}))),onSearch:e=>{x(e),e.length>0&&g({input:e})},onSelect:async e=>{const l=await(0,de.c)(e);v({lat:null===l||void 0===l?void 0:l.geometry.location.lat,lng:null===l||void 0===l?void 0:l.geometry.location.lng})}})}),(0,_.jsx)(Q.c.Item,{label:a("map"),children:(0,_.jsx)(ae.c,{location:c,setLocation:v,setAddress:e=>t.setFieldsValue({address:e})})})]})})}var ce=n(73568),ue=n(83072),ve=n.n(ue),pe=n(48820);const he=[{title:"sunday"},{title:"monday"},{title:"tuesday"},{title:"wednesday"},{title:"thursday"},{title:"friday"},{title:"saturday"}],me=()=>{var e,l,n,d,o,r;const{t:c}=(0,h.G)(),v=(0,u.OY)(),p=(0,u.w1)((e=>(0,j.KG)(e.cart))),{activeMenu:x}=(0,u.w1)((e=>e.menu),u.G),{currentBag:g}=(0,u.w1)((e=>e.cart),u.G),f=(0,u.w1)((e=>(0,j.KG)(e.cart))),b=new Date(p.delivery_date),S=null===(e=x.data)||void 0===e||null===(l=e.CurrentShop)||void 0===l||null===(n=l.shop_working_days)||void 0===n?void 0:n.filter((e=>!0!==e.disabled)).find((e=>{var l;return(null===e||void 0===e?void 0:e.day)===(null===(l=he[b.getDay()])||void 0===l?void 0:l.title)})),w=null===(d=x.data)||void 0===d||null===(o=d.CurrentShop)||void 0===o||null===(r=o.shop_closed_date)||void 0===r?void 0:r.map((e=>e.day));const k=(e,l)=>{const n=[];for(let i=e;i<l;i++)n.push(i);return n};return(0,i.useEffect)((()=>{var e,l,n;null!==f&&void 0!==f&&null!==(e=f.shop)&&void 0!==e&&e.value&&(n=null===f||void 0===f||null===(l=f.shop)||void 0===l?void 0:l.value,pe.c.getById(n).then((e=>{const l=e.data;v((0,m.SS)({currency_shop:l,bag_id:g})),v((0,y.MH)({activeMenu:x,data:{...x.data,CurrentShop:e.data}}))})))}),[null===f||void 0===f?void 0:f.shop]),(0,_.jsx)(a.default,{title:c("shipping.info"),className:"p-0",children:(0,_.jsxs)(t.c,{gutter:12,children:[(0,_.jsx)(s.c,{span:24,children:(0,_.jsx)(Q.c.Item,{name:"delivery",label:c("delivery"),rules:[{required:!0,message:c("required")}],children:(0,_.jsx)(Z.default,{placeholder:c("delivery.type"),options:[{label:"delivery",value:1,key:1},{label:"pickup",value:0,key:2}],labelInValue:!0,onSelect:e=>v((0,m.SS)({delivery_fee:e.value,bag_id:g})),onChange:e=>v((0,m.SS)({deliveries:e,bag_id:g}))})})}),(0,_.jsx)(s.c,{span:24,children:(0,_.jsxs)(t.c,{gutter:12,children:[(0,_.jsx)(s.c,{span:12,children:(0,_.jsx)(Q.c.Item,{name:"delivery_date",label:c("delivery.date"),rules:[{required:!0,message:c("required")}],valuePropName:"date",children:(0,_.jsx)(ce.default,{placeholder:c("delivery.date"),className:"w-100",format:"YYYY-MM-DD",disabledDate:function(e){const l=null===w||void 0===w?void 0:w.find((l=>l===ve()(e).format("YYYY-MM-DD"))),n=ve()().add(-1,"days")>=e;return l||n},onChange:e=>{const l=ve()(e).format("YYYY-MM-DD");v((0,m.SS)({delivery_date:l,bag_id:g}))}})})}),(0,_.jsx)(s.c,{span:12,children:(0,_.jsx)(Q.c.Item,{label:"".concat(c("delivery.time")," (").concat(c("up.to"),")"),name:"delivery_time",rules:[{required:!1,message:c("required")}],valuePropName:"date",children:(0,_.jsx)(ce.default,{disabled:!p.delivery_date,picker:"time",placeholder:c("start.time"),className:"w-100",format:"HH:mm:ss",showNow:!1,disabledTime:()=>({disabledHours:()=>((e,l)=>{const n=parseInt(e),i=parseInt(l),a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24];for(let t=n;t<=i;t++)delete a[t];return a})(ve()(new Date).format("DD")===ve()(p.delivery_date).format("DD")?(null===S||void 0===S?void 0:S.from.substring(0,2))>=ve()(new Date).format("HH")?null===S||void 0===S?void 0:S.from.substring(0,2):ve()(new Date).format("HH"):null===S||void 0===S?void 0:S.from.substring(0,2),null===S||void 0===S?void 0:S.to.substring(0,2)),disabledMinutes:()=>k(0,60),disabledSeconds:()=>k(0,60)}),onChange:e=>{const l=ve()(e).format("HH:mm:ss");v((0,m.SS)({delivery_time:l,bag_id:g}))}})})})]})})]})})};function xe(){var e,l,n;const{t:d}=(0,h.G)(),[o]=Q.c.useForm(),r=(0,u.OY)(),{currencies:c,loading:v}=(0,u.w1)((e=>e.currency),u.G),{currentBag:p,bags:x,currency:y}=(0,u.w1)((e=>e.cart),u.G),g=(0,u.w1)((e=>(0,j.KG)(e.cart))),{payments:b}=(0,u.w1)((e=>e.payment),u.G),[S,k]=(0,i.useState)([]),[N,C]=(0,i.useState)(null),[G,M]=(0,i.useState)(null),[P,O]=(0,i.useState)(null),B=(0,u.w1)((e=>(0,j.KG)(e.cart))),{payment_type:Y,before_order_phone_required:F}=(0,u.w1)((e=>e.globalSettings.settings),u.G);return(0,i.useEffect)((()=>{if(y){const e={label:"".concat(null===y||void 0===y?void 0:y.title," (").concat(null===y||void 0===y?void 0:y.symbol,")"),value:null===y||void 0===y?void 0:y.id};r((0,m.SS)({formCurrency:e,bag_id:p})),o.setFieldsValue({currency:e})}else{const e=c.find((e=>e.default)),l={label:"".concat(null===e||void 0===e?void 0:e.title," (").concat(null===e||void 0===e?void 0:e.symbol,")"),value:null===e||void 0===e?void 0:e.id};r((0,m.SS)({currentCurrency:e,bag_id:p})),r((0,m.IX)(e)),o.setFieldsValue({currency:l})}}),[]),(0,i.useEffect)((()=>{o.setFieldsValue({user:g.user||null,payment_type:g.paymentType||null,address:g.address.address||null,delivery:g.deliveries||null,delivery_time:(null===g||void 0===g?void 0:g.delivery_time)||null,delivery_date:(null===g||void 0===g?void 0:g.delivery_date)||null,phone:(null===g||void 0===g?void 0:g.phone)||null})}),[p,g]),(0,_.jsxs)("div",{className:"order-tabs",children:[(0,_.jsxs)("div",{className:"tabs-container",children:[(0,_.jsx)("div",{className:"tabs",children:x.map((e=>(0,_.jsx)("div",{className:e===p?"tab active":"tab",onClick:()=>r((0,m.ov)(e)),children:(0,_.jsxs)(E.c,{children:[(0,_.jsx)(R.c,{}),(0,_.jsxs)("span",{children:[d("bag")," - ",e]}),e&&e===p?(0,_.jsx)($.c,{onClick:l=>((e,l)=>{e.preventDefault(),e.stopPropagation(),r((0,m.CY)(l))})(l,e),className:"close-button",size:12}):""]})},"tab"+e)))}),(0,_.jsx)(D.c,{size:"small",type:"primary",shape:"circle",icon:(0,_.jsx)(q.c,{}),className:"tab-add-button",onClick:()=>r((0,m.Zo)({shop:B.shop}))})]}),(0,_.jsxs)(Q.c,{layout:"vertical",name:"pos-form",form:o,initialValues:{user:g.user||null,currency:y||void 0,payment_type:g.paymentType||null,deliveries:g.deliveries,delivery:{label:"pickup",value:"0"},delivery_time:null,delivery_date:null,phone:g.phone||null},children:[(0,_.jsxs)(a.default,{className:p?"":"tab-card",children:[v&&(0,_.jsx)("div",{className:"loader",children:(0,_.jsx)(w.c,{})}),(0,_.jsxs)(t.c,{gutter:6,style:{marginBottom:15},children:[(0,_.jsx)(s.c,{span:9,children:(0,_.jsx)(Q.c.Item,{name:"user",rules:[{required:!0,message:""}],className:"w-100",children:(0,_.jsx)(f.I,{hasMore:null===P||void 0===P?void 0:P.next,placeholder:d("select.client"),fetchOptions:async function(e){let{search:l,page:n}=e;const i={search:l,perPage:10};return le.c.getAll(i).then((e=>(O(e.links),k(e.data),function(e){if(!e)return;return(0,ne.isArray)(e)?e.map((e=>({label:"".concat(e.firstname," ").concat(e.lastname?e.lastname:""),value:e.id}))):{label:"".concat(e.firstname," ").concat(e.lastname),value:e.id}}(e.data))))},onSelect:function(e){const l=S.find((l=>l.id===e.value));r((0,m.SS)({user:e,userUuid:null===l||void 0===l?void 0:l.uuid,bag_id:p,userOBJ:l,phone:null===l||void 0===l?void 0:l.phone})),o.setFieldsValue({address:null,phone:null===l||void 0===l?void 0:l.phone})},onClear:()=>{o.setFieldsValue({phone:null,user:null})}})})}),(0,_.jsx)(s.c,{span:3,children:(0,_.jsx)(Q.c.Item,{children:(0,_.jsx)(D.c,{icon:(0,_.jsx)(ee.c,{}),onClick:()=>M(!0)})})}),"1"===F&&(0,_.jsx)(s.c,{span:12,children:(0,_.jsx)(Q.c.Item,{name:"phone",rules:[{required:!0,message:d("required")},{validator(e,l){if(l<0)return Promise.reject(new Error(d("must.be.positive")))}}],children:(0,_.jsx)(X.c,{className:"w-100",placeholder:d("phone.number"),disabled:null===g||void 0===g||null===(e=g.userOBJ)||void 0===e?void 0:e.phone,onChange:e=>r((0,m.SS)({phone:e,bag_id:p}))})})}),(0,_.jsx)(s.c,{span:12,children:(0,_.jsx)(Q.c.Item,{name:"address",rules:[{required:!0,message:""}],onClick:()=>{g.userUuid?C(g.userUuid):I.m4.warning(d("please.select.client"))},children:(0,_.jsx)(W.default,{autoComplete:"off",placeholder:d("address")})})}),(0,_.jsx)(s.c,{span:12,children:(0,_.jsx)(Q.c.Item,{name:"currency",rules:[{required:!0,message:"missing_currency"}],children:(0,_.jsx)(Z.default,{placeholder:d("select.currency"),onSelect:function(e){const l=c.find((l=>l.id===e.value));r((0,m.IX)(l))},labelInValue:!0,disabled:!0,onChange:e=>{const l=e;r((0,m.SS)({currency:l,bag_id:p}))},children:c.map(((e,l)=>(0,_.jsx)(Z.default.Option,{value:null===e||void 0===e?void 0:e.id,children:"".concat(null===e||void 0===e?void 0:e.title," (").concat(null===e||void 0===e?void 0:e.symbol,")")},l)))})})}),(0,_.jsx)(s.c,{span:12,children:(0,_.jsx)(Q.c.Item,{name:"payment_type",rules:[{required:!0,message:d("missing.payment.type")}],children:(0,_.jsx)(Z.default,{placeholder:d("select.payment.type"),labelInValue:!0,onSelect:e=>r((0,m.SS)({paymentType:e,bag_id:p})),children:null===(l="admin"===Y?b:null===B||void 0===B?void 0:B.payment_type)||void 0===l||null===(n=l.filter((e=>"cash"===e.tag||"wallet"===e.tag)))||void 0===n?void 0:n.map(((e,l)=>(0,_.jsx)(Z.default.Option,{value:e.id,children:null===e||void 0===e?void 0:e.tag},l)))})})})]})]}),(0,_.jsx)(me,{})]}),N&&(0,_.jsx)(re,{uuid:N,handleCancel:()=>C(null)}),G&&(0,_.jsx)(ie,{visible:G,handleCancel:()=>M(!1)})]})}var ye=n(59424),je=n(4496),ge=n(77020),fe=n(2916),_e=n(68048),be=n(54572),Se=n(62220),we=n(84620),ke=n.n(we);function Ne(){var e,l;const{t:n}=(0,h.G)(),[o]=Q.c.useForm(),r=(0,u.OY)(),{cartItems:p,cartShops:x,currentBag:y,total:g,coupons:f,currency:b,notes:S}=(0,u.w1)((e=>e.cart),u.G),k=(0,u.w1)((e=>(0,j.QX)(e.cart))),N=(0,u.w1)((e=>(0,j.KG)(e.cart))),[G,P]=(0,i.useState)([]),[O,F]=(0,i.useState)(!1),[V,H]=(0,i.useState)(null),[K,z]=(0,i.useState)(null),[T,A]=(0,i.useState)(""),U=(0,be.c)(p,300),J=(0,u.w1)((e=>(0,j.KG)(e.cart)));console.log("total",g);const L=e=>{var l;e.quantity!==(null===e||void 0===e||null===(l=e.stockID)||void 0===l?void 0:l.quantity)&&e.quantity!==e.max_qty&&r((0,m.iA)({...e,quantity:1}))},X=e=>{1!==e.quantity&&(e.quantity<=e.min_qty||r((0,m.W8)({...e,quantity:1})))};function Z(){const e=function(e){var l,n,i,a,t,s;const d=e.map((e=>{var l,n;return{quantity:e.quantity,stock_id:e.stockID?null===(l=e.stockID)||void 0===l?void 0:l.id:null===(n=e.stock)||void 0===n?void 0:n.id}})),o=e.flatMap((e=>e.addons.map((l=>{var n,i;return{quantity:l.quantity,stock_id:l.stockID,parent_id:e.stockID?null===(n=e.stockID)||void 0===n?void 0:n.id:null===(i=e.stock)||void 0===i?void 0:i.id}})))),r={products:d.concat(o),currency_id:null===b||void 0===b?void 0:b.id,coupon:null===(l=f[0])||void 0===l?void 0:l.coupon,shop_id:null===N||void 0===N||null===(n=N.shop)||void 0===n?void 0:n.value,type:null===N||void 0===N||null===(i=N.deliveries)||void 0===i||null===(a=i.label)||void 0===a?void 0:a.toLowerCase(),address:{latitude:null===N||void 0===N||null===(t=N.address)||void 0===t?void 0:t.lat,longitude:null===N||void 0===N||null===(s=N.address)||void 0===s?void 0:s.lng}};return ke().stringify(r,{addQueryPrefix:!0})}(k);F(!0),ge.c.calculate(e).then((e=>{var l;let{data:n}=e;const i=n.data,a=i.stocks.map((e=>({...k.find((l=>l.id===e.id)),...e,...e.stock.countable,stock:e.stock.stock_extras,stocks:e.stock.stock_extras,stockID:e.stock})));let t=[{...G,products:a}];r((0,m.oz)(t));const s={product_total:null===(l=i.stocks)||void 0===l?void 0:l.reduce(((e,l)=>e+(l.total_price||l.price)),0),product_tax:i.total_tax,shop_tax:i.total_shop_tax,order_total:i.total_price,delivery_fee:i.delivery_fee,service_fee:null===i||void 0===i?void 0:i.service_fee,couponOBJ:null===i||void 0===i?void 0:i.coupon};r((0,m.uq)(s))})).finally((()=>F(!1)))}(0,i.useEffect)((()=>{var e;null!==N&&void 0!==N&&null!==(e=N.shop)&&void 0!==e&&e.value&&function(){var e;d.c.getById(null===N||void 0===N||null===(e=N.shop)||void 0===e?void 0:e.value).then((e=>P(e.data)))}()}),[]),(0,c.c)((()=>{var e;r((0,v.yK)({perPage:12,currency_id:null===b||void 0===b?void 0:b.id,shop_id:null===N||void 0===N||null===(e=N.shop)||void 0===e?void 0:e.value,active:1})),k.length&&Z()}),[b]),(0,c.c)((()=>{k.length?Z():r((0,m._G)())}),[U,y,null===N||void 0===N?void 0:N.address,b,f,N.coupon]);function R(e,l){Se.c.create(e,l).then((e=>(e=>{H(e)})(e.data.id))).finally((()=>F(!1)))}return(0,_.jsxs)(a.default,{children:[O&&(0,_.jsx)("div",{className:"loader",children:(0,_.jsx)(w.c,{})}),(0,_.jsxs)("div",{className:"card-save",children:[null===x||void 0===x?void 0:x.map(((e,l)=>{var i,a,d,o,c,u;return(0,_.jsxs)("div",{children:[(0,_.jsxs)("div",{className:"all-price",children:[(0,_.jsxs)("span",{className:"title",children:[null===e||void 0===e||null===(i=e.translation)||void 0===i?void 0:i.title," ",n("shop")]}),(0,_.jsxs)("span",{className:"counter",children:[null===e||void 0===e||null===(a=e.products)||void 0===a?void 0:a.length," ",(null===e||void 0===e||null===(d=e.products)||void 0===d?void 0:d.length)>1?n("products"):n("product")]})]}),null===e||void 0===e||null===(o=e.products)||void 0===o?void 0:o.map(((e,l)=>{var i,a,d,o,c,u,v,p,h,x;return!0!==(null===e||void 0===e?void 0:e.bonus)?(0,_.jsx)("div",{className:"custom-cart-container",children:(0,_.jsxs)(t.c,{className:"product-row",children:[(0,_.jsx)(M.c,{width:70,height:"auto",src:(0,C.c)(null===e||void 0===e?void 0:e.img),preview:!0,placeholder:!0,className:"rounded"}),(0,_.jsx)(s.c,{span:18,className:"product-col",children:(0,_.jsxs)("div",{children:[(0,_.jsx)("span",{className:"product-name",children:null===e||void 0===e||null===(i=e.translation)||void 0===i?void 0:i.title}),(0,_.jsx)("br",{}),(0,_.jsx)(E.c,{wrap:!0,className:"mt-2",children:null===e||void 0===e||null===(a=e.stock)||void 0===a?void 0:a.map(((e,l)=>(0,_.jsx)("span",{className:"extras-text rounded pr-2 pl-2",children:e.value},l+"-"+e.value)))}),(0,_.jsx)("br",{}),(0,_.jsx)(E.c,{wrap:!0,className:"mt-2",children:null===e||void 0===e||null===(d=e.addons)||void 0===d?void 0:d.map(((e,l)=>{var n,i;return(0,_.jsxs)("span",{className:"extras-text rounded pr-2 pl-2",children:[null===e||void 0===e||null===(n=e.countable)||void 0===n||null===(i=n.translation)||void 0===i?void 0:i.title," x"," ",null===e||void 0===e?void 0:e.quantity]},l+"-"+(null===e||void 0===e?void 0:e.quantity))}))}),(0,_.jsxs)("div",{className:"product-counter",children:[(0,_.jsx)("span",{children:(0,Y.c)((null===e||void 0===e?void 0:e.total_price)||(null===e||void 0===e?void 0:e.price),null===b||void 0===b?void 0:b.symbol)}),(0,_.jsxs)("div",{className:"count",children:[(0,_.jsx)(D.c,{className:"button-counter",shape:"circle",icon:(0,_.jsx)(B.c,{size:14}),onClick:()=>X(e)}),(0,_.jsxs)("span",{children:[(null===e||void 0===e?void 0:e.countable_quantity)*((null===e||void 0===e?void 0:e.interval)||1),null===e||void 0===e||null===(o=e.unit)||void 0===o||null===(c=o.translation)||void 0===c?void 0:c.title]}),(0,_.jsx)(D.c,{className:"button-counter",shape:"circle",icon:(0,_.jsx)(q.c,{size:14}),onClick:()=>L(e)}),(0,_.jsx)(D.c,{className:"button-counter",shape:"circle",onClick:()=>{return l=e,r((0,m.Qd)(l));var l},icon:(0,_.jsx)(ye.c,{size:14})})]})]})]})}),(0,_.jsx)(s.c,{span:24,children:(0,_.jsx)(W.default,{placeholder:n("note"),className:"w-100 mt-2",defaultValue:S[e.stockID.id],onBlur:l=>r((0,m.UD)({label:e.stockID.id,value:l.target.value||void 0}))})})]})},(null===e||void 0===e?void 0:e.id)+"_"+l):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("h4",{className:"mt-2",children:[" ",n("Bonus.product")," "]}),(0,_.jsx)("div",{className:"custom-cart-container",children:(0,_.jsxs)(t.c,{className:"product-row",children:[(0,_.jsx)(M.c,{width:70,height:"auto",src:(0,C.c)(null===e||void 0===e?void 0:e.img),preview:!0,placeholder:!0,className:"rounded"}),(0,_.jsx)(s.c,{span:18,className:"product-col",children:(0,_.jsxs)("div",{children:[(0,_.jsx)("span",{className:"product-name",children:null===e||void 0===e||null===(u=e.translation)||void 0===u?void 0:u.title}),(0,_.jsx)("br",{}),(0,_.jsx)(E.c,{wrap:!0,className:"mt-2",children:null===e||void 0===e||null===(v=e.stock)||void 0===v?void 0:v.map(((e,l)=>(0,_.jsx)("span",{className:"extras-text rounded pr-2 pl-2",children:null===e||void 0===e?void 0:e.value},l+"_"+(null===e||void 0===e?void 0:e.value))))}),(0,_.jsx)("br",{}),(0,_.jsx)(E.c,{wrap:!0,className:"mt-2",children:null===(p=e.addons)||void 0===p?void 0:p.map(((e,l)=>{var n,i;return(0,_.jsxs)("span",{className:"extras-text rounded pr-2 pl-2",children:[null===e||void 0===e||null===(n=e.countable)||void 0===n||null===(i=n.translation)||void 0===i?void 0:i.title," x"," ",null===e||void 0===e?void 0:e.quantity]},l+"_"+(null===e||void 0===e?void 0:e.quantity))}))}),(0,_.jsxs)("div",{className:"product-counter",children:[(0,_.jsx)("span",{children:(0,Y.c)((null===e||void 0===e?void 0:e.total_price)||(null===e||void 0===e?void 0:e.price),null===b||void 0===b?void 0:b.symbol)}),(0,_.jsxs)("div",{className:"count",children:[(0,_.jsx)(D.c,{className:"button-counter",shape:"circle",icon:(0,_.jsx)(B.c,{size:14}),onClick:()=>X(e),disabled:!0}),(0,_.jsxs)("span",{children:[(null===e||void 0===e?void 0:e.quantity)*((null===e||void 0===e?void 0:e.interval)||1),null===e||void 0===e||null===(h=e.unit)||void 0===h||null===(x=h.translation)||void 0===x?void 0:x.title]}),(0,_.jsx)(D.c,{className:"button-counter",shape:"circle",icon:(0,_.jsx)(q.c,{size:14}),onClick:()=>L(e),disabled:!0})]})]})]})})]})},e.id+"_"+l)]})})),(0,_.jsxs)("div",{className:"d-flex my-3",children:[(0,_.jsx)(W.default,{placeholder:n("coupon"),className:"w-100 mr-2",addonAfter:null!==(c=f.find((l=>l.shop_id===e.id)))&&void 0!==c&&c.verified?(0,_.jsx)(je.c,{style:{color:"#18a695"}}):null,defaultValue:null===(u=f.find((l=>l.shop_id===e.id)))||void 0===u?void 0:u.coupon,onBlur:l=>{var n;return r((0,m.ew)({coupon:l.target.value,user_id:null===N||void 0===N||null===(n=N.user)||void 0===n?void 0:n.value,shop_id:e.id,verified:!1}))},onChange:e=>A(e.target.value)}),(0,_.jsx)(D.c,{disabled:0===T.trim().length||T.trim().length<2,onClick:()=>{var l,n,i;return function(e){const l={coupon:T,shop_id:e};z(e),fe.c.checkCoupon(l).then((l=>{const n=l.data.id;r((0,m.SS)({coupon:n,bag_id:y})),r((0,m.uA)({shop_id:e,price:l.data.price,verified:!0})),r((0,m.WG)(l.data))})).catch((()=>r((0,m.uA)({shop_id:e,price:0,verified:!1})))).finally((()=>z(null)))}(null===e||void 0===e||null===(l=e.products)||void 0===l||null===(n=l[0])||void 0===n||null===(i=n.shop)||void 0===i?void 0:i.id)},loading:K===e.id,children:n("check.coupon")})]})]},e.uuid+"_"+l)})),(0,_.jsx)(t.c,{className:"all-price-row",children:(0,_.jsxs)(s.c,{span:24,className:"col",children:[(0,_.jsxs)("div",{className:"all-price-container",children:[(0,_.jsx)("span",{children:n("sub.total")}),(0,_.jsx)("span",{children:(0,Y.c)(g.product_total,null===b||void 0===b?void 0:b.symbol)})]}),(0,_.jsxs)("div",{className:"all-price-container",children:[(0,_.jsx)("span",{children:n("shop.tax")}),(0,_.jsx)("span",{children:(0,Y.c)(g.shop_tax,null===b||void 0===b?void 0:b.symbol)})]}),(0,_.jsxs)("div",{className:"all-price-container",children:[(0,_.jsx)("span",{children:n("delivery.fee")}),(0,_.jsx)("span",{children:(0,Y.c)(g.delivery_fee,null===b||void 0===b?void 0:b.symbol)})]}),(0,_.jsxs)("div",{className:"all-price-container",children:[(0,_.jsx)("span",{children:n("service.fee")}),(0,_.jsx)("span",{children:(0,Y.c)(g.service_fee,null===b||void 0===b?void 0:b.symbol)})]}),(null===g||void 0===g||null===(e=g.couponOBJ)||void 0===e?void 0:e.price)&&(0,_.jsxs)("div",{className:"all-price-container",children:[(0,_.jsx)("span",{children:n("coupon")}),(0,_.jsxs)("span",{style:{color:"red"},children:["- ",(0,Y.c)(null===g||void 0===g||null===(l=g.couponOBJ)||void 0===l?void 0:l.price,null===b||void 0===b?void 0:b.symbol)]})]})]})}),(0,_.jsxs)(t.c,{className:"submit-row",children:[(0,_.jsxs)(s.c,{span:14,className:"col",children:[(0,_.jsx)("span",{children:n("total.amount")}),(0,_.jsx)("span",{children:(0,Y.c)(g.order_total,null===b||void 0===b?void 0:b.symbol)})]}),(0,_.jsx)(s.c,{className:"col2",children:(0,_.jsx)(D.c,{type:"primary",onClick:()=>(()=>{var e,l,i,a,t,s,d,c;if(!b)return void I.m4.warning(n("please.select.currency"));if(!N.address)return void I.m4.warning(n("please.select.address"));if(!N.delivery_time)return void I.m4.warning(n("shop.closed"));if(!N.delivery_date)return void I.m4.warning(n("please.select.deliveryDate"));F(!0);const u=null===p||void 0===p?void 0:p.map((e=>{var l,n;return{stock_id:null===(l=e.stockID)||void 0===l?void 0:l.id,quantity:e.quantity,bonus:e.bonus,note:S[null===(n=e.stockID)||void 0===n?void 0:n.id]}})),v=null===p||void 0===p?void 0:p.flatMap((e=>{var l;return null===(l=e.addons)||void 0===l?void 0:l.map((l=>({stock_id:l.stockID,quantity:l.quantity,parent_id:e.stockID.id})))})),h={user_id:null===(e=N.user)||void 0===e?void 0:e.value,currency_id:null===b||void 0===b?void 0:b.id,rate:b.rate,shop_id:N.shop.value,delivery_id:N.deliveries.label,delivery_fee:N.delivery_fee,coupon:null===(l=f[0])||void 0===l?void 0:l.coupon,tax:g.order_tax,payment_type:null===(i=N.paymentType)||void 0===i?void 0:i.label,delivery_date:N.delivery_date,delivery_address_id:null===(a=N.address)||void 0===a?void 0:a.address,address:{address:null===(t=N.address)||void 0===t?void 0:t.address,office:null,house:null,floor:null},location:{latitude:null===(s=N.address)||void 0===s?void 0:s.lat,longitude:null===(d=N.address)||void 0===d?void 0:d.lng},delivery_time:ve()(N.delivery_time,"HH:mm").format("HH:mm"),delivery_type:N.deliveries.label.toLowerCase(),delivery_type_id:N.deliveries.value,products:u.concat(...v),phone:null===N||void 0===N||null===(c=N.phone)||void 0===c?void 0:c.toString()},x={payment_sys_id:N.paymentType.value};ge.c.create(h).then((e=>{r((0,m.IP)(e.data)),R(e.data.id,x),o.resetFields()})).catch((e=>console.error(e))).finally((()=>F(!1)))})(),disabled:!x.length,loading:O,children:n("place.order")})})]})]}),V?(0,_.jsx)(_e.c,{orderId:V,handleClose:()=>{H(null),r((0,m.am)()),0!==y&&r((0,m.CY)(y)),I.m4.success(n("successfully.closed")),r((0,v.yK)({perPage:12,currency_id:null===b||void 0===b?void 0:b.id,shop_id:null===J||void 0===J?void 0:J.shop.value,active:1}))}}):""]})}function qe(){return(0,_.jsx)("div",{className:"pos-system",children:(0,_.jsx)(S.default,{className:"site-layout",children:(0,_.jsxs)(t.c,{gutter:24,children:[(0,_.jsxs)(s.c,{span:15,children:[(0,_.jsx)(b,{}),(0,_.jsx)(L,{})]}),(0,_.jsxs)(s.c,{span:9,children:[(0,_.jsx)(xe,{}),(0,_.jsx)(Ne,{})]})]})})})}}}]);