"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[5120],{5120:(e,t,o)=>{o.r(t),o.d(t,{default:()=>b});var l=o(99584),a=o(67692),n=o(65732),i=o(68496),d=o(23424),s=o(32712),r=o(65236),c=o(49600),u=o(84832),v=o(95688),m=o(78016),_=o(20556),f=o(18896),h=o(33131),p=o(83072),g=o.n(p),y=o(29480),x=o(12344),F=o(61072),j=o(97884);const{Step:S}=a.default;function b(){var e,t,o,p,b,C,N,M,w,H,Y,k;const{t:G}=(0,r.G)(),[E]=n.c.useForm(),O=(0,_.W)(),D=(0,s.OY)(),J=(0,d.i6)(),{activeMenu:L}=(0,s.w1)((e=>e.menu),s.G),{settings:T}=(0,s.w1)((e=>e.globalSettings),s.G),{defaultCurrency:V}=(0,s.w1)((e=>e.currency),s.G),I=Number((null===(e=O.values)||void 0===e?void 0:e.step)||0),[Q,U]=(0,l.useState)(!1),[W,q]=(0,l.useState)((null===L||void 0===L||null===(t=L.data)||void 0===t?void 0:t.images)||[]),[z,A]=(0,l.useState)(null!==L&&void 0!==L&&null!==(o=L.data)&&void 0!==o&&o.location_from?{lat:parseFloat(null===L||void 0===L||null===(p=L.data)||void 0===p||null===(b=p.location_from)||void 0===b?void 0:b.latitude),lng:parseFloat(null===L||void 0===L||null===(C=L.data)||void 0===C||null===(N=C.location_from)||void 0===N?void 0:N.longitude)}:(0,h.c)(T)),[B,K]=(0,l.useState)(null!==L&&void 0!==L&&null!==(M=L.data)&&void 0!==M&&M.location_to?{lat:parseFloat(null===L||void 0===L||null===(w=L.data)||void 0===w||null===(H=w.location_to)||void 0===H?void 0:H.latitude),lng:parseFloat(null===L||void 0===L||null===(Y=L.data)||void 0===Y||null===(k=Y.location_to)||void 0===k?void 0:k.longitude)}:(0,h.c)(T));(0,l.useEffect)((()=>()=>{const e=E.getFieldsValue(!0),t=JSON.stringify(e.delivery_date),o=JSON.stringify(e.delivery_time),l={...e,date:t,time:o};D((0,f.MH)({activeMenu:L,data:l}))}),[]);const P=()=>{const e=I+1;O.set("step",e)},R=()=>{const e=I-1;O.set("step",e)};return(0,j.jsxs)(i.default,{title:G("add.parcel.order"),children:[(0,j.jsx)(a.default,{current:I,onChange:e=>{O.set("step",e)},children:c.C.map((e=>(0,j.jsx)(S,{title:G(e.title)},e.title)))}),(0,j.jsx)("div",{className:"steps-content",children:(0,j.jsxs)(n.c,{form:E,name:"parcel-create",layout:"vertical",onFinish:e=>{var t,o;console.log("values => ",e),U(!0);const l={user_id:null===(t=e.user_from)||void 0===t?void 0:t.value,currency_id:null===V||void 0===V?void 0:V.id,type_id:null===(o=e.type)||void 0===o?void 0:o.value,rate:null===V||void 0===V?void 0:V.rate,phone_from:e.phone_from.toString(),username_from:e.username_from,address_from:{longitude:null===z||void 0===z?void 0:z.lng,latitude:null===z||void 0===z?void 0:z.lat,address:e.address_from,house:e.house_from,stage:e.stage_from,room:e.room_from},phone_to:e.phone_to.toString(),username_to:e.username_to,address_to:{longitude:null===B||void 0===B?void 0:B.lng,latitude:null===B||void 0===B?void 0:B.lat,address:e.address_to,house:e.house_to,stage:e.stage_to,room:e.room_to},delivery_date:g()(e.delivery_date).format("YYYY-MM-DD"),delivery_time:g()(e.delivery_time,"HH:mm").format("HH:mm"),note:e.note,images:W.map((e=>e.name))},a={payment_sys_id:e.payment_type.value};y.c.create(l).then((e=>function(e,t){const o="parcel-orders";y.c.transaction(e,t).then((()=>{D((0,x.Q1)()),F.m4.success(G("successfully.created")),D((0,f.MF)({...L,nextUrl:o})),J("/".concat(o))})).finally((()=>U(!1)))}(e.data.id,a))).catch((()=>U(!1)))},initialValues:{...L.data},onFinishFailed:e=>{const t=["","",""];e.errorFields.map((e=>e.name[0])).forEach((e=>{e.includes("_from")?t[0]="sender.details.invalid":e.includes("_to")?t[1]="receiver.details.invalid":t[2]="parcel.details.invalid"})),t.forEach((e=>{e&&F.m4.error(G(e))}))},children:[(0,j.jsx)("div",{className:"First-content"===c.C[I].content?"":"d-none",children:(0,j.jsx)(u.c,{form:E,next:P,location:z,setLocation:A})}),(0,j.jsx)("div",{className:"Second-content"===c.C[I].content?"":"d-none",children:(0,j.jsx)(v.c,{form:E,next:P,prev:R,location:B,setLocation:K})}),(0,j.jsx)("div",{className:"Third-content"===c.C[I].content?"":"d-none",children:(0,j.jsx)(m.c,{form:E,loading:Q,prev:R,locationFrom:z,locationTo:B,image:W,setImage:q})})]})})]})}}}]);