"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[4320],{84190:(e,l,t)=>{t.d(l,{u:()=>o});var a=t(99584),n=t(10876),i=t(37728),s=t(95976),d=t.n(s),c=t(97884);const o=e=>{let{fetchOptions:l,refetch:t=!1,debounceTimeout:s=400,...o}=e;const[r,u]=(0,a.useState)(!1),[v,m]=(0,a.useState)([]),p=(0,a.useMemo)((()=>d()((e=>{m([]),u(!0),l(e).then((e=>{m(e),u(!1)}))}),s)),[]);return(0,c.jsx)(n.default,{showSearch:!0,labelInValue:!0,filterTreeNode:(e,l)=>{var t;return null===(t=l.label)||void 0===t?void 0:t.localeCompare(e)},treeLine:!0,onSearch:e=>p(e),treeData:r?[]:v,treeDefaultExpandAll:!0,onFocus:()=>{v.length&&!t||(u(!0),l().then((e=>{m(e),u(!1)})))},notFoundContent:r?(0,c.jsx)(i.c,{size:"small"}):"no results",...o})}},1428:(e,l,t)=>{t.d(l,{c:()=>o});t(99584);var a=t(87228),n=t(59424),i=t(61072),s=t(65236),d=t(75088),c=t(97884);function o(e){let{size:l="",onClick:t,type:o="default",...r}=e;const{t:u}=(0,s.G)(),{isDemo:v}=(0,d.c)();return(0,c.jsx)(a.c,{size:l,icon:(0,c.jsx)(n.c,{}),onClick:e=>{v?i.m4.warning(u("cannot.work.demo")):t(e)},type:o,...r})}},424:(e,l,t)=>{t.d(l,{c:()=>o});var a=t(99584),n=t(79416),i=t(32712),s=t(51840),d=t(48376),c=t(97884);const o=()=>{const e=(0,i.OY)(),{languages:l,defaultLang:t}=(0,i.w1)((e=>e.formLang),i.G);(0,a.useEffect)((()=>{d.c.getAllActive().then((l=>{let{data:t}=l;e((0,s.Up)(t)),e((0,s.uY)(t.find((e=>1===e.default)).locale))}))}),[]);return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(n.cp.Group,{value:t,onChange:l=>{let{target:{value:t}}=l;e((0,s.uY)(t))},className:"float-right",buttonStyle:"solid",children:null===l||void 0===l?void 0:l.map((e=>(0,c.jsx)(n.cp.Button,{value:e.locale,children:e.title},e.id)))})})}},6428:(e,l,t)=>{t.d(l,{u:()=>o});var a=t(99584),n=t(95976),i=t.n(n),s=t(2664),d=t(37728),c=t(97884);const o=e=>{let{fetchOptions:l,debounceTimeout:t=400,refetch:n=!1,...o}=e;const[r,u]=(0,a.useState)(!1),[v,m]=(0,a.useState)([]),p=(0,a.useMemo)((()=>i()((e=>{m([]),u(!0),l(e).then((e=>{m(e),u(!1)}))}),t)),[l,t]);return(0,c.jsx)(s.default,{showSearch:!0,allowClear:!0,labelInValue:!0,onClear:()=>p(""),filterOption:!1,onSearch:p,notFoundContent:r?(0,c.jsx)(d.c,{size:"small"}):"no results",...o,options:v,onFocus:()=>{p("")}})}},71376:(e,l,t)=>{t.d(l,{g:()=>o});var a=t(99584),n=t(95976),i=t.n(n),s=t(2664),d=t(37728),c=t(97884);const o=e=>{let{fetchOptions:l,debounceTimeout:t=400,onClear:n,...o}=e;const[r,u]=(0,a.useState)(!1),[v,m]=(0,a.useState)([]),p=(0,a.useMemo)((()=>i()((e=>{m([]),u(!0),l(e).then((e=>{m(e),u(!1)}))}),t)),[l,t]);return(0,c.jsx)(s.default,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:p,onClear:()=>{p(""),n&&n()},notFoundContent:r?(0,c.jsx)(d.c,{size:"small"}):"no results",...o,options:v,onFocus:()=>{p("")}})}},74968:(e,l,t)=>{t.d(l,{c:()=>a});const a=function(e){let l=[],t=e.length-1;return function a(n,i){for(let d=0,c=null===(s=e[i])||void 0===s?void 0:s.length;d<c;d++){var s;let c=n.slice(0);c.push(e[i][d]),i===t?l.push(c):a(c,i+1)}}([],0),l}},56384:(e,l,t)=>{function a(e,l){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"title";const a=e.map((e=>({[e.locale]:""===l["".concat(t,"[").concat(e.locale,"]")]?void 0:l["".concat(t,"[").concat(e.locale,"]")]})));return Object.assign({},...a)}t.d(l,{c:()=>a})},54572:(e,l,t)=>{t.d(l,{c:()=>n});var a=t(99584);function n(e,l){const[t,n]=(0,a.useState)(e);return(0,a.useEffect)((()=>{const t=setTimeout((()=>{n(e)}),l);return()=>{clearTimeout(t)}}),[e,l]),t}},86416:(e,l,t)=>{t.d(l,{c:()=>j});var a=t(99584),n=t(65732),i=t(95884),s=t(87228),d=t(46712),c=t(65236),o=t(424),r=t(32712),u=t(71588),v=t(61072),m=t(32764),p=t(56384),h=t(77180),x=t(97884);function j(e){let{modal:l,handleCancel:t,onSuccess:j}=e;const[g]=n.c.useForm(),{t:f}=(0,c.G)(),y=(0,r.OY)(),[b,k]=(0,a.useState)(!1),[q,w]=(0,a.useState)(!1),{languages:I,defaultLang:S}=(0,r.w1)((e=>e.formLang),r.G);(0,a.useEffect)((()=>{var e;null!==l&&void 0!==l&&l.id&&(e=l.id,w(!0),u.c.getGroupById(e).then((e=>{const l=e.data;g.setFieldsValue({...l,...C(l)})})).finally((()=>w(!1))))}),[l]);function C(e){if(!e)return{};const{translations:l}=e,t=I.map((e=>{var t;return{["title[".concat(e.locale,"]")]:null===(t=l.find((l=>l.locale===e.locale)))||void 0===t?void 0:t.title}}));return Object.assign({},...t)}return(0,x.jsx)(i.default,{title:null!==l&&void 0!==l&&l.id?f("edit.extra.group"):f("add.extra.group"),visible:!!l,onCancel:t,footer:[(0,x.jsx)(s.c,{type:"primary",onClick:()=>g.submit(),loading:b,children:f("save")},"save-button-group"),(0,x.jsx)(s.c,{type:"default",onClick:t,children:f("cancel")},"cancel-button-group")],children:q?(0,x.jsx)(h.c,{}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"d-flex justify-content-end",children:(0,x.jsx)(o.c,{})}),(0,x.jsx)(n.c,{layout:"vertical",name:"extra-group",form:g,onFinish:e=>{const a={title:(0,p.c)(I,e),type:"text"};null!==l&&void 0!==l&&l.id?function(e,l){k(!0),u.c.updateGroup(e,l).then((()=>{v.m4.success(f("successfully.updated")),y((0,m.ee)()),t()})).finally((()=>k(!1)))}(null===l||void 0===l?void 0:l.id,a):function(e){k(!0),u.c.createGroup(e).then((()=>{v.m4.success(f("successfully.created")),t(),y((0,m.ee)()),j&&j()})).finally((()=>k(!1)))}(a)},children:I.map((e=>(0,x.jsx)(n.c.Item,{rules:[{required:e.locale===S,message:f("required")}],name:"title[".concat(e.locale,"]"),label:f("title"),hidden:e.locale!==S,children:(0,x.jsx)(d.default,{placeholder:f("title")})},"title"+e.locale)))})]})})}},72664:(e,l,t)=>{t.d(l,{c:()=>g});var a=t(65732),n=t(46712),i=t(95884),s=t(87228),d=t(99584),c=t(5332),o=t(65236),r=t(32712),u=t(61072),v=t(36136),m=t(49580),p=t(68392),h=t(71588),x=t(71376),j=t(97884);function g(e){let{modal:l,handleCancel:t,onSuccess:g,groupId:f}=e;const[y]=a.c.useForm(),{t:b}=(0,o.G)(),k=(0,r.OY)(),[q,w]=(0,d.useState)(!1),[I,S]=(0,d.useState)("text"),[C,_]=(0,d.useState)(null),[N,E]=(0,d.useState)(""),{extraGroups:F}=(0,r.w1)((e=>e.extraGroup),r.G);(0,d.useEffect)((()=>{if(null!==l&&void 0!==l&&l.id){var e,t,a;S(l.group.type);const n={...l,extra_group_id:{label:null===l||void 0===l||null===(e=l.group)||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title,value:null===l||void 0===l||null===(a=l.group)||void 0===a?void 0:a.id},value:l.value};switch(l.group.type){case"color":E(l.value);break;case"image":_((0,m.c)(l.value))}y.setFieldsValue(n)}f&&y.setFieldsValue({extra_group_id:{value:f}})}),[l,f]);function P(e,l){switch(e){case"color":return l.hex;case"text":return l;case"image":return l.name;default:return""}}return(0,j.jsx)(i.default,{title:null!==l&&void 0!==l&&l.id?b("edit.extra"):b("add.extra"),visible:!!l,onCancel:t,footer:[(0,j.jsx)(s.c,{type:"primary",onClick:()=>y.submit(),loading:q,children:b("save")}),(0,j.jsx)(s.c,{type:"default",onClick:t,children:b("cancel")})],children:(0,j.jsxs)(a.c,{name:"extra-form",layout:"vertical",form:y,onFinish:e=>{var a;console.log(e);const n={extra_group_id:null===e||void 0===e||null===(a=e.extra_group_id)||void 0===a?void 0:a.value,value:P(I,e.value)};null!==l&&void 0!==l&&l.id?((e,l)=>{w(!0),h.c.updateValue(e,l).then((()=>{u.m4.success(b("successfully.updated")),t(),k((0,p.i2)())})).finally((()=>w(!1)))})(l.id,n):(e=>{w(!0),h.c.createValue(e).then((()=>{u.m4.success(b("successfully.created")),t(),k((0,p.i2)()),g&&g()})).finally((()=>w(!1)))})(n)},children:[(0,j.jsx)(a.c.Item,{name:"extra_group_id",label:b("extra.group"),hidden:!!f,rules:[{required:!0,message:""}],children:(0,j.jsx)(x.g,{fetchOptions:async function(e){const l={perPage:10,active:1,search:e};return console.log("search => ",l),h.c.getAllGroups(l).then((e=>{var l;return null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.map((e=>{var l;return{value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,key:null===e||void 0===e?void 0:e.id}}))}))}})}),(0,j.jsx)(a.c.Item,{name:"value",label:b("value"),rules:[{required:!0,message:""}],children:(e=>{switch(e){case"color":return(0,j.jsx)(c.aS,{onChangeComplete:e=>E(e.hex),color:N,disableAlpha:!0});case"text":return(0,j.jsx)(n.default,{placeholder:b("enter.extra.value")});case"image":return(0,j.jsx)(v.c,{type:"extras",image:C,setImage:_,form:y,name:"value"});default:return""}})(I)})]})})}},32176:(e,l,t)=>{t.d(l,{c:()=>E});var a=t(99584),n=t(68496),i=t(65732),s=t(66296),d=t(87228),c=t(32712),o=t(10580),r=t(18896),u=t(65236),v=t(23424),m=t(61072),p=t(88992),h=t(95884),x=t(46712),j=t(69168),g=t(98044),f=t(77748),y=t(71588),b=t(86416),k=t(94936),q=t(54572),w=t(97884);const I=e=>{let{open:l,onClose:t,selectedExtras:n,onSelect:i}=e;const{t:s}=(0,u.G)(),[c,o]=(0,a.useState)([]),[r,v]=(0,a.useState)(!1),[m,p]=(0,a.useState)(!1),[I,S]=(0,a.useState)(""),C=(0,q.c)(I,500),[_,N]=(0,a.useState)(),E=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;v(!0);const t={valid:!0,perPage:10,search:e,page:l};y.c.getAllGroups(t).then((e=>{const l=e.data.map((e=>{var l;return{id:e.id,label:null===(l=e.translation)||void 0===l?void 0:l.title,value:e.id,shop_id:e.shop_id}}));o(l),N(e.meta)})).finally((()=>v(!1)))};return(0,a.useEffect)((()=>{l&&E(C)}),[l,C]),(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(h.default,{visible:l,onCancel:()=>{t(),S("")},footer:r?null:(0,w.jsx)(d.c,{type:"link",onClick:()=>p(!0),style:{paddingLeft:0},icon:(0,w.jsx)(k.c,{}),children:s("add.new.extra")}),children:[(0,w.jsx)(x.default,{className:"mt-3",value:I,onChange:e=>S(e.target.value)}),(0,w.jsx)(j.cp,{loading:r,dataSource:c.filter((e=>!(null!==n&&void 0!==n&&n.some((l=>l.id===e.id))))),renderItem:e=>(0,w.jsx)(j.cp.Item,{extra:null!==e&&void 0!==e&&e.shop_id?null:(0,w.jsx)(g.c,{children:s("admin")}),style:{cursor:"pointer"},onClick:()=>{i(e)},children:e.label})}),(0,w.jsx)(f.c,{onChange:e=>{E(C,e)},current:null===_||void 0===_?void 0:_.current_page,total:null===_||void 0===_?void 0:_.total})]}),(0,w.jsx)(b.c,{modal:m,handleCancel:()=>p(!1),onSuccess:()=>E()})]})};var S=t(59528),C=t(97836),_=t(72664);const N=e=>{let{extra:l,onClose:t,onSelect:n}=e;const{t:i}=(0,u.G)(),[s,c]=(0,a.useState)(!1),[o,r]=(0,a.useState)([]),[v,m]=(0,a.useState)([]),[p,x]=(0,a.useState)(!1);function g(e){c(!0),y.c.getGroupById(e).then((e=>r(e.data.extra_values.map((e=>({label:e.value,value:e.id})))))).finally((()=>{c(!1)}))}return(0,a.useEffect)((()=>{var e;null!==l&&void 0!==l&&l.value&&(g(l.value),m((null===l||void 0===l||null===(e=l.values)||void 0===e?void 0:e.map((e=>e.value)))||[]))}),[null===l||void 0===l?void 0:l.value]),console.log(l),(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(h.default,{visible:!!l,onCancel:t,footer:[(0,w.jsx)(d.c,{onClick:t,children:i("cancel")}),!s&&o.length>0&&(0,w.jsx)(d.c,{onClick:()=>{const e=[];o.forEach((l=>{v.forEach((t=>{l.value===t&&e.push(l)}))})),n(null===l||void 0===l?void 0:l.value,e),t()},type:"primary",children:i("save")})],children:[(0,w.jsx)(S.c.Group,{value:v,onChange:e=>{m(e)},className:"w-100",children:0!==(null===o||void 0===o?void 0:o.length)||s?(0,w.jsx)(j.cp,{dataSource:o,loading:s,renderItem:e=>(0,w.jsx)(j.cp.Item,{children:(0,w.jsx)(S.c,{value:e.value,children:null===e||void 0===e?void 0:e.label})})}):(0,w.jsx)(C.c,{})}),s?null:(0,w.jsx)(d.c,{type:"link",onClick:()=>x(!0),style:{paddingLeft:0},icon:(0,w.jsx)(k.c,{}),children:i("add.new.extra")})]}),l&&(0,w.jsx)(_.c,{modal:p,handleCancel:()=>x(!1),groupId:null===l||void 0===l?void 0:l.value,onSuccess:()=>g(null===l||void 0===l?void 0:l.value)})]})},E=e=>{var l;let{next:t,prev:h,isRequest:x}=e;const{t:j}=(0,u.G)(),g=(0,c.OY)(),{uuid:f,id:y}=(0,v.W4)(),b=(0,v.i6)(),{activeMenu:k}=(0,c.w1)((e=>e.menu),c.G),[q,S]=(0,a.useState)(!1),[C,_]=(0,a.useState)(!1),[E,F]=(0,a.useState)((null===(l=k.data)||void 0===l?void 0:l.extras)||[]),[P,G]=(0,a.useState)(null),[O,M]=(0,a.useState)(!1);return(0,w.jsx)(n.default,{children:(0,w.jsxs)(i.c,{layout:"vertical",initialValues:{...k.data},onFinish:()=>{if(E.some((e=>{var l;return 0===(null===(l=e.values)||void 0===l?void 0:l.length)||!e.values})))return void m.m4.error(j("please.select.at.least.1.extra.value.for.each.extra"));const e=E.map((e=>e.value));if(e.sort(((e,l)=>e-l)),x)return g((0,r.MH)({activeMenu:k,data:{...k.data,extras:E}})),void b("/product-request/".concat(y,"?step=2"),{state:{generate:O}});S(!0),o.c.extras(f,{extras:e}).then((()=>{g((0,r.MH)({activeMenu:k,data:{...k.data,extras:E}})),t()})).finally((()=>S(!1)))},children:[(0,w.jsx)(I,{open:C,onClose:()=>_(!1),selectedExtras:E,onSelect:e=>{M(!0),F((l=>[...l,e])),_(!1)}}),(0,w.jsx)(N,{extra:P,onClose:()=>G(null),onSelect:(e,l)=>{M(!0),F((t=>t.map((t=>{if(t.value===e){const e=l.map((e=>{var l,t;const a=null===(l=k.data)||void 0===l||null===(t=l.extras)||void 0===t?void 0:t.flatMap((e=>e.values)).find((l=>l.value===e.value));return{...e,stock_id:null===a||void 0===a?void 0:a.stock_id}}));return{...t,values:e}}return t}))))}}),(0,w.jsx)(s.c,{className:"w-100",size:"middle",direction:"vertical",children:E.map((e=>{var l;return(0,w.jsxs)(s.c,{className:"w-100",direction:"vertical",children:[(0,w.jsxs)(s.c,{className:"w-100",wrap:!0,children:[(0,w.jsx)(d.c,{onClick:()=>G(e),ghost:!0,type:"primary",children:null===e||void 0===e?void 0:e.label}),null===e||void 0===e||null===(l=e.values)||void 0===l?void 0:l.map((l=>(0,w.jsxs)("div",{className:"extra-value",children:[null===l||void 0===l?void 0:l.label," ",(0,w.jsx)("button",{onClick:()=>{return t=e.value,a=l.value,M(!0),void F((e=>e.map((e=>e.value===t?{...e,values:(null===e||void 0===e?void 0:e.values.filter((e=>e.value!==a)))||[]}:e))));var t,a},type:"button",className:"extra-clear",children:(0,w.jsx)(p.OSk,{})})]},l.value)))]}),(0,w.jsx)(s.c,{className:"w-100",style:{justifyContent:"flex-end"},children:(0,w.jsx)(d.c,{danger:!0,onClick:()=>{return l=e,M(!0),void F((e=>e.filter((e=>e.id!==l.id))));var l},type:"text",children:j("delete")})})]},e.id)}))}),(0,w.jsx)(d.c,{onClick:()=>_(!0),className:"w-100 my-3",type:"dashed",children:j("add.extra")}),(0,w.jsxs)(s.c,{className:"mt-3",children:[(0,w.jsx)(d.c,{onClick:h,children:j("prev")}),(0,w.jsx)(d.c,{type:"primary",htmlType:"submit",loading:q,children:j("next")})]})]})})}},87904:(e,l,t)=>{t.d(l,{c:()=>b});var a=t(99584),n=t(68496),i=t(37564),s=t(68768),d=t(10260),c=t(66296),o=t(87228),r=t(37728),u=t(32712),v=t(23424),m=t(18896),p=t(63616),h=t(65236),x=t(10580),j=t(52640),g=t(61072),f=t(68660),y=t(97884);const b=e=>{var l,t,b,k,q,w,I,S,C,_,N,E,F;let{prev:P,isRequest:G}=e;const{t:O}=(0,h.G)(),{activeMenu:M}=(0,u.w1)((e=>e.menu),u.G),{defaultLang:L,languages:V}=(0,u.w1)((e=>e.formLang),u.G),W=(0,v.i6)(),T=(0,u.OY)(),[A,Y]=(0,a.useState)({}),[H,z]=(0,a.useState)(null),{uuid:B}=(0,v.W4)(),[R,D]=(0,a.useState)(!1);function U(e){if(null===e||void 0===e||!e.translations)return{};const{translations:l}=e,t=V.map((e=>{var t,a;return{["title[".concat(e.locale,"]")]:null===(t=l.find((l=>l.locale===e.locale)))||void 0===t?void 0:t.title,["description[".concat(e.locale,"]")]:null===(a=l.find((l=>l.locale===e.locale)))||void 0===a?void 0:a.description}}));return Object.assign({},...t)}(0,a.useEffect)((()=>{G||function(e){z(!0),x.c.getById(e).then((e=>{const l={...e.data,...U(e.data),properties:e.data.properties.map(((e,l)=>({id:l,["key[".concat(e.locale,"]")]:e.key,["value[".concat(e.locale,"]")]:e.value}))),translation:void 0,translations:void 0};Y(l)})).finally((()=>z(!1)))}(B)}),[G]);const K=M.data,X=G?M.data.model:A;return H?(0,y.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,y.jsx)(r.c,{size:"large",className:"py-5"})}):(0,y.jsxs)(n.default,{children:[G&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(i.c,{bordered:!0,title:O("changed.info"),children:[(0,y.jsx)(i.c.Item,{label:"".concat(O("title")," (").concat(L,")"),span:3,children:K["title[".concat(L,"]")]}),(0,y.jsx)(i.c.Item,{label:"".concat(O("description")," (").concat(L,")"),span:3,children:K["description[".concat(L,"]")]}),(0,y.jsx)(i.c.Item,{label:O("shop"),span:1.5,children:null===K||void 0===K||null===(l=K.shop)||void 0===l?void 0:l.translation.title}),(0,y.jsx)(i.c.Item,{label:O("category"),span:1.5,children:null===K||void 0===K||null===(t=K.category)||void 0===t?void 0:t.label}),(0,y.jsx)(i.c.Item,{label:O("brand"),span:1.5,children:null===K||void 0===K||null===(b=K.brand)||void 0===b?void 0:b.label}),(0,y.jsx)(i.c.Item,{label:O("unit"),span:1.5,children:null===K||void 0===K||null===(k=K.unit)||void 0===k?void 0:k.label}),(0,y.jsx)(i.c.Item,{label:O("images"),span:3,children:(0,y.jsx)(s.c,{gutter:12,children:null===K||void 0===K||null===(q=K.images)||void 0===q?void 0:q.map(((e,l)=>(0,y.jsx)(d.c,{children:(0,y.jsx)("img",{width:80,alt:"product",src:e.url})},"image"+l)))})}),(0,y.jsx)(i.c.Item,{label:O("tax"),children:(null===K||void 0===K?void 0:K.tax)||0}),(0,y.jsx)(i.c.Item,{label:O("min.quantity"),children:null===K||void 0===K?void 0:K.min_qty}),(0,y.jsx)(i.c.Item,{label:O("max.quantity"),children:null===K||void 0===K?void 0:K.max_qty})]}),null===K||void 0===K?void 0:K.stocks.map(((e,l)=>{var t;return e?(0,y.jsxs)(i.c,{bordered:!0,className:"mt-4",children:[(0,y.jsx)(i.c.Item,{label:O("price"),span:2,children:e.price}),(0,y.jsx)(i.c.Item,{label:O("quantity"),span:2,children:e.quantity}),null===e||void 0===e||null===(t=e.ids)||void 0===t?void 0:t.map(((e,l)=>(0,y.jsx)(i.c.Item,{label:null===K||void 0===K?void 0:K.extras[l].label,children:null===e||void 0===e?void 0:e.label},"extra"+l)))]},"desc"+l):""}))]}),(0,y.jsxs)(i.c,{bordered:!0,className:"mt-4",title:O("original.info"),children:[(0,y.jsx)(i.c.Item,{label:"".concat(O("title")," (").concat(L,")"),span:3,column:3,children:(null===(w=X.translation)||void 0===w?void 0:w.title)||X["title[".concat(L,"]")]}),(0,y.jsx)(i.c.Item,{label:"".concat(O("description")," (").concat(L,")"),span:3,column:3,children:(null===X||void 0===X||null===(I=X.translation)||void 0===I?void 0:I.description)||X["description[".concat(L,"]")]}),(0,y.jsx)(i.c.Item,{label:O("shop"),span:1.5,column:1.5,children:null===(S=X.shop)||void 0===S?void 0:S.translation.title}),(0,y.jsx)(i.c.Item,{label:O("category"),span:1.5,column:1.5,children:null===(C=X.category)||void 0===C?void 0:C.translation.title}),(0,y.jsx)(i.c.Item,{label:O("brand"),span:1.5,column:1.5,children:null===(_=X.brand)||void 0===_?void 0:_.title}),(0,y.jsx)(i.c.Item,{label:O("unit"),span:1.5,column:1.5,children:null===(N=X.unit)||void 0===N?void 0:N.translation.title}),(0,y.jsx)(i.c.Item,{label:O("images"),span:3,column:3,children:(0,y.jsx)(s.c,{gutter:12,children:null===X||void 0===X||null===(E=X.galleries)||void 0===E?void 0:E.map(((e,l)=>(0,y.jsx)(d.c,{children:(0,y.jsx)("img",{width:80,alt:"product",src:j.cd+e.path})},"image"+l)))})}),(0,y.jsx)(i.c.Item,{span:3,column:3,label:O("tax"),children:X.tax||0}),(0,y.jsx)(i.c.Item,{span:3,column:3,label:O("min.quantity"),children:X.min_qty}),(0,y.jsx)(i.c.Item,{span:3,column:3,label:O("max.quantity"),children:X.max_qty})]}),null===(F=X.stocks)||void 0===F?void 0:F.map(((e,l)=>e?(0,y.jsxs)(i.c,{bordered:!0,className:"mt-4",children:[(0,y.jsx)(i.c.Item,{label:O("price"),span:2,column:2,children:e.price}),(0,y.jsx)(i.c.Item,{label:O("quantity"),span:2,column:2,children:e.quantity}),e.extras.map(((e,l)=>{var t,a;return(0,y.jsx)(i.c.Item,{label:null===e||void 0===e||null===(t=e.group)||void 0===t||null===(a=t.translation)||void 0===a?void 0:a.title,span:2,column:2,children:null===e||void 0===e?void 0:e.value},"extra"+l)}))]},"desc"+l):"")),(0,y.jsx)("div",{className:"d-flex justify-content-end mt-4",children:(0,y.jsxs)(c.c,{children:[(0,y.jsx)(o.c,{onClick:P,children:O("prev")}),(0,y.jsx)(o.c,{loading:R,type:"primary",onClick:function(){const e={status:void 0},l="catalog/products";if(G&&M.data){D(!0);const e={id:M.data.model_id,type:"product",data:M.data};f.c.requestChangeUpdate(M.data.request_id,e).then((()=>{W("/".concat(l),{state:{tab:"request"}}),g.m4.success(O("successfully.updated")),T((0,m.MF)({...M,nextUrl:l}))})).finally((()=>{D(!1)}))}else T((0,m.MF)({...M,nextUrl:l})),T((0,p.mA)(e)),W("/".concat(l))},children:O("finish")})]})})]})}},80956:(e,l,t)=>{t.d(l,{c:()=>I});var a=t(99584),n=t(65732),i=t(66296),s=t(87228),d=t(95884),c=t(7400),o=t(68496),r=t(68768),u=t(10260),v=t(46712),m=t(15752),p=t(36668),h=t(59424),x=t(32712),j=t(424),g=t(65236),f=t(97884);function y(e){let{editData:l,handleCancel:t,editProperty:i}=e;const{t:s}=(0,g.G)(),[c]=n.c.useForm(),{defaultLang:o,languages:m}=(0,x.w1)((e=>e.formLang),x.G);return(0,a.useEffect)((()=>{c.setFieldsValue(l)}),[l]),(0,f.jsxs)(d.default,{title:"Edit product property",visible:!!l,okText:"Save",onCancel:t,onOk:()=>c.submit(),children:[(0,f.jsx)(r.c,{className:"mb-3",children:(0,f.jsx)(u.c,{span:24,children:(0,f.jsx)(j.c,{})})}),(0,f.jsx)(n.c,{form:c,layout:"vertical",onFinish:e=>{const t={...l,...e};i(t)},children:(0,f.jsxs)(r.c,{className:"mt-4",children:[(0,f.jsx)(u.c,{span:24,children:m.map((e=>(0,f.jsx)(n.c.Item,{label:"Key",name:"key[".concat(e.locale,"]"),rules:[{validator:(l,t)=>t||(null===e||void 0===e?void 0:e.locale)!==o?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(s("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(s("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(s("required")))}],hidden:e.locale!==o,children:(0,f.jsx)(v.default,{})},"key"+e.locale)))}),(0,f.jsx)(u.c,{span:24,children:m.map((e=>(0,f.jsx)(n.c.Item,{label:"Value",name:"value[".concat(e.locale,"]"),rules:[{validator:(l,t)=>t||(null===e||void 0===e?void 0:e.locale)!==o?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(s("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(s("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(s("required")))}],hidden:e.locale!==o,children:(0,f.jsx)(v.default,{})},"value"+e.locale)))})]})})]})}var b=t(18896),k=t(10580),q=t(23424),w=t(1428);const I=e=>{var l;let{next:t,prev:j,isRequest:I}=e;const{t:S}=(0,g.G)(),C=(0,x.OY)(),{uuid:_}=(0,q.W4)(),{activeMenu:N}=(0,x.w1)((e=>e.menu),x.G),{defaultLang:E,languages:F}=(0,x.w1)((e=>e.formLang),x.G),[P]=n.c.useForm(),[G,O]=(0,a.useState)(null),[M,L]=(0,a.useState)((null===(l=N.data)||void 0===l?void 0:l.properties)||[]),[V,W]=(0,a.useState)(!1),T=[{key:"2",title:S("key"),render:(e,l)=>l["key[".concat(E,"]")]},{key:"4",title:S("value"),render:(e,l)=>l["value[".concat(E,"]")]},{key:"5",title:S("options"),render:e=>(0,f.jsxs)(i.c,{children:[(0,f.jsx)(s.c,{type:"primary",icon:(0,f.jsx)(p.c,{}),onClick:()=>O(e)}),(0,f.jsx)(w.c,{type:"primary",danger:!0,icon:(0,f.jsx)(h.c,{}),onClick:()=>A(e)})]})}];(0,a.useEffect)((()=>{if(M.length&&_){const e=M;C((0,b.MH)({activeMenu:N,data:{...N.data,properties:e}}))}}),[M]);const A=e=>{d.default.confirm({title:S("delete.product"),okText:S("yes"),okType:"danger",onOk:()=>{L((l=>l.filter((l=>l.id!==e.id))))}})},Y=()=>O(null);return(0,f.jsxs)(o.default,{children:[(0,f.jsx)(n.c,{layout:"vertical",form:P,onFinish:e=>{const l={...e,id:parseInt(50*Math.random())};L((e=>[...e,l])),P.resetFields()},children:(0,f.jsxs)(r.c,{gutter:12,className:"mb-3",children:[(0,f.jsx)(u.c,{span:8,children:F.map((e=>(0,f.jsx)(n.c.Item,{name:"key[".concat(e.locale,"]"),rules:[{validator:(l,t)=>t||(null===e||void 0===e?void 0:e.locale)!==E?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(S("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(S("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(S("required")))}],hidden:e.locale!==E,children:(0,f.jsx)(v.default,{placeholder:"Key"})},"key"+e.locale)))}),(0,f.jsx)(u.c,{span:8,children:F.map((e=>(0,f.jsx)(n.c.Item,{name:"value[".concat(e.locale,"]"),rules:[{validator:(l,t)=>t||(null===e||void 0===e?void 0:e.locale)!==E?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(S("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(S("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(S("required")))}],hidden:e.locale!==E,children:(0,f.jsx)(v.default,{placeholder:S("value")})},"value"+e.locale)))}),(0,f.jsx)(u.c,{span:4,children:(0,f.jsx)(s.c,{type:"primary",htmlType:"submit",children:S("save")})})]})}),(0,f.jsx)(m.c,{scroll:{x:!0},columns:T,dataSource:M,pagination:!1,rowKey:e=>e.id}),G&&(0,f.jsx)(y,{editData:G,handleCancel:Y,editProperty:e=>{L((l=>l.map((l=>l.id===e.id?e:l)))),Y()}}),(0,f.jsxs)(i.c,{className:"mt-4",children:[(0,f.jsx)(s.c,{onClick:j,children:S("prev")}),(0,f.jsx)(s.c,{type:"primary",onClick:function(){const e=function(){let e=[],l=[];return M.forEach((t=>{let a={},n={};F.forEach((e=>{a[e.locale]=t["key[".concat(e.locale,"]")],n[e.locale]=t["value[".concat(e.locale,"]")]})),e.push(a),l.push(n)})),{key:e,value:l}}();if(I)return C((0,b.MH)({activeMenu:N,data:{...N.data,properties:M,props:e}})),void t();W(!0),k.c.properties(_,e).then((()=>{c.cp.success(S("product.properties.saved")),t()})).finally((()=>W(!1)))},loading:V,children:S("next")})]})]})}},51432:(e,l,t)=>{t.d(l,{c:()=>q});var a=t(99584),n=t(65732),i=t(68496),s=t(68768),d=t(10260),c=t(2664),o=t(46712),r=t(10240),u=t(87228),v=t(66296),m=t(32712),p=t(59424),h=t(10580),x=t(65236),j=t(23424),g=t(71376),f=t(77180),y=t(74968),b=t(18896),k=t(97884);const q=e=>{var l;let{prev:t,next:q,isRequest:w}=e;const{t:I}=(0,x.G)(),[S]=n.c.useForm(),{uuid:C}=(0,j.W4)(),{activeMenu:_}=(0,m.w1)((e=>e.menu),m.G),[N,E]=(0,a.useState)(null),[F,P]=(0,a.useState)(null),[G,O]=(0,a.useState)([]),M=(0,m.OY)(),L=(0,j.IT)(),{defaultLang:V}=(0,m.w1)((e=>e.formLang),m.G),{defaultCurrency:W}=(0,m.w1)((e=>e.currency),m.G);const T=e=>{var l;const t={search:e,addon:1,shop_id:null===_||void 0===_||null===(l=_.data)||void 0===l?void 0:l.shop_id,"statuses[0]":"published","statuses[1]":"pending",active:1};return h.c.getAll(t).then((e=>e.data.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id}}))))};return(0,a.useEffect)((()=>{var e;if(w)if(null!==(e=L.state)&&void 0!==e&&e.generate){var l,t,a,n,i;const e=(0,y.c)(null===_||void 0===_||null===(l=_.data.extras)||void 0===l?void 0:l.map((e=>e.values||[]))),r=e.map((e=>{var l,t;if(e.every((e=>"undefined"!==typeof e.stock_id))){var a,n,i;const l=null===(a=_.data)||void 0===a||null===(n=a.actualStocks)||void 0===n?void 0:n.find((l=>l.extras.every((l=>e.some((e=>e.value===l.id)))))),t=[];return null===l||void 0===l||null===(i=l.addons)||void 0===i||i.forEach((e=>{var l,a,n;e.product&&t.push({label:(null===e||void 0===e||null===(l=e.product)||void 0===l||null===(a=l.translation)||void 0===a?void 0:a.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(n=e.product)||void 0===n?void 0:n.id)||(null===e||void 0===e?void 0:e.value)})})),{price:(null===l||void 0===l?void 0:l.price)||0,quantity:(null===l||void 0===l?void 0:l.quantity)||0,stock_id:null===l||void 0===l?void 0:l.id,tax:(null===_||void 0===_?void 0:_.data.tax)||0,addons:t,...Object.assign({},...e.map(((e,l)=>({["extras[".concat(l,"]")]:{label:e.label,value:e.value,group:_.data.extras[l].label}}))))}}return{price:0,quantity:0,tax:(null===(l=_.data)||void 0===l?void 0:l.tax)||0,sku:null===_||void 0===_||null===(t=_.data)||void 0===t?void 0:t.sku,addons:[],...Object.assign({},...e.map(((e,l)=>({["extras[".concat(l,"]")]:{label:e.label,value:e.value}}))))}}));let u=[];if(0===e.length&&0!==(null===(t=_.data)||void 0===t||null===(a=t.actualStocks)||void 0===a?void 0:a.length)){var s,d,c;const e=null===(s=_.data.actualStocks)||void 0===s?void 0:s.at(0),l=[];null===e||void 0===e||null===(d=e.addons)||void 0===d||d.forEach((e=>{var t,a,n;e.product&&l.push({label:(null===e||void 0===e||null===(t=e.product)||void 0===t||null===(a=t.translation)||void 0===a?void 0:a.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(n=e.product)||void 0===n?void 0:n.id)||(null===e||void 0===e?void 0:e.value)})})),u=[{price:(null===e||void 0===e?void 0:e.price)||0,quantity:(null===e||void 0===e?void 0:e.quantity)||0,sku:null===e||void 0===e?void 0:e.sku,tax:(null===(c=_.data)||void 0===c?void 0:c.tax)||0,addons:e?l:[]}]}var o;if(0===e.length&&0===(null===_||void 0===_||null===(n=_.data)||void 0===n||null===(i=n.actualStocks)||void 0===i?void 0:i.length))u=[{price:void 0,quantity:0,sku:null===_||void 0===_?void 0:_.data.sku,tax:(null===(o=_.data)||void 0===o?void 0:o.tax)||0,addons:[]}];const v=u.concat(r);O(_.data.actualStocks.map((e=>e.id))),S.setFieldsValue({stocks:v})}else{var r,u;const e=null===(r=_.data.stocks)||void 0===r?void 0:r.map((e=>{var l;return{price:e.price,quantity:e.quantity,tax:_.data.tax,stock_id:e.stock_id,sku:e.sku,...Object.assign({},...null===(l=e.ids)||void 0===l?void 0:l.map(((e,l)=>({["extras[".concat(l,"]")]:{label:e.label,value:e.value,group:e.group}})))),addons:e.addons}}));O((null===(u=_.data)||void 0===u?void 0:u.delete_ids)||[]),S.setFieldsValue({stocks:e})}else!function(e){P(!0),h.c.getById(e).then((e=>{var l,t,a;const n=(0,y.c)(null===_||void 0===_||null===(l=_.data.extras)||void 0===l?void 0:l.map((e=>e.values||[]))),i=n.map(((l,t)=>{var a,n;if(l.every((e=>"undefined"!==typeof e.stock_id))){var i;const t=e.data.stocks.find((e=>e.extras.every((e=>l.some((l=>l.value===e.id)))))),a=[];return null===t||void 0===t||null===(i=t.addons)||void 0===i||i.forEach((e=>{var l,t,n;e.product&&a.push({label:(null===e||void 0===e||null===(l=e.product)||void 0===l||null===(t=l.translation)||void 0===t?void 0:t.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(n=e.product)||void 0===n?void 0:n.id)||(null===e||void 0===e?void 0:e.value)})})),{price:(null===t||void 0===t?void 0:t.price)||0,quantity:(null===t||void 0===t?void 0:t.quantity)||0,sku:null===t||void 0===t?void 0:t.sku,stock_id:null===t||void 0===t?void 0:t.id,tax:(null===_||void 0===_?void 0:_.data.tax)||0,addons:a,...Object.assign({},...l.map(((e,l)=>({["extras[".concat(l,"]")]:{label:e.label,value:e.value}}))))}}return{price:0,quantity:0,sku:null===_||void 0===_||null===(a=_.data)||void 0===a?void 0:a.sku,tax:(null===(n=_.data)||void 0===n?void 0:n.tax)||0,addons:[],...Object.assign({},...l.map(((e,l)=>({["extras[".concat(l,"]")]:{label:e.label,value:e.value}}))))}}));let s=[];if(0===n.length&&0!==(null===(t=e.data.stocks)||void 0===t?void 0:t.length)){var d,c,o;const l=null===(d=e.data.stocks)||void 0===d?void 0:d.at(0),t=[];null===l||void 0===l||null===(c=l.addons)||void 0===c||c.forEach((e=>{var l,a,n;e.product&&t.push({label:(null===e||void 0===e||null===(l=e.product)||void 0===l||null===(a=l.translation)||void 0===a?void 0:a.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(n=e.product)||void 0===n?void 0:n.id)||(null===e||void 0===e?void 0:e.value)})})),s=[{price:(null===l||void 0===l?void 0:l.price)||0,quantity:(null===l||void 0===l?void 0:l.quantity)||0,sku:null===l||void 0===l?void 0:l.sku,tax:(null===(o=_.data)||void 0===o?void 0:o.tax)||0,addons:l?t:[]}]}var r,u;0===n.length&&0===(null===(a=e.data.stocks)||void 0===a?void 0:a.length)&&(s=[{price:void 0,quantity:0,sku:null===_||void 0===_||null===(r=_.data)||void 0===r?void 0:r.sku,tax:(null===(u=_.data)||void 0===u?void 0:u.tax)||0,addons:[]}]);const v=s.concat(i);O(e.data.stocks.map((e=>e.id))),S.setFieldsValue({stocks:v})})).finally((()=>{P(!1)}))}(C)}),[w,null===(l=L.state)||void 0===l?void 0:l.generate]),(0,k.jsx)(i.default,{title:_.data["title[".concat(V,"]")]?'"'.concat(_.data["title[".concat(V,"]")],'"'):"",children:F?(0,k.jsx)(f.c,{}):(0,k.jsxs)(n.c,{layout:"vertical",form:S,onFinish:e=>{var l,t;const{stocks:a}=e,n=G.filter(((e,l)=>{var t;return!(null===(t=a[l])||void 0===t||!t.stock_id)&&!a.some((l=>(null===l||void 0===l?void 0:l.stock_id)===e))}));let i;const s=!(null===(l=_.data)||void 0===l||null===(t=l.extras)||void 0===t||!t.length);if(i=s?a.map(((e,l)=>{var t,a,n,i;return{price:e.price,quantity:e.quantity,sku:e.sku,ids:w?null===(t=_.data)||void 0===t?void 0:t.extras.map(((l,t)=>e["extras[".concat(t,"]")])):null===(a=_.data)||void 0===a?void 0:a.extras.map(((l,t)=>e["extras[".concat(t,"]")].value)),addons:e.addons?w?null===(n=e.addons)||void 0===n?void 0:n.map((e=>e)):null===(i=e.addons)||void 0===i?void 0:i.map((e=>e.value)):[],stock_id:e.stock_id}})):[{price:a[0].price,quantity:a[0].quantity,addons:a[0].addons?w?a[0].addons.map((e=>e)):a[0].addons.map((e=>e.value)):[],stock_id:a[0].stock_id,sku:a[0].sku,ids:[]}],w)return M((0,b.MH)({activeMenu:_,data:{..._.data,stocks:i,delete_ids:n}})),void q();E(!0),h.c.stocks(C,{extras:i,delete_ids:n}).then((()=>{M((0,b.MH)({activeMenu:_,data:{..._.data,stocks:i,delete_ids:n}})),q()})).finally((()=>E(!1)))},children:[(0,k.jsx)(n.c.List,{name:"stocks",children:(e,l)=>{let{add:t,remove:a}=l;return(0,k.jsx)("div",{children:e.map(((e,l)=>{var t,i,v,m;return(0,k.jsxs)(s.c,{gutter:12,align:"middle",style:{flexWrap:"nowrap",overflowX:"auto"},hidden:!(null!==(t=_.data)&&void 0!==t&&null!==(i=t.extras)&&void 0!==i&&i.length)&&e.key,children:[null===(v=_.data)||void 0===v||null===(m=v.extras)||void 0===m?void 0:m.map(((e,t)=>(0,k.jsx)(d.c,{children:(0,k.jsx)(n.c.Item,{label:null===e||void 0===e?void 0:e.label,name:[l,"extras[".concat(t,"]")],rules:[{required:!0,message:I("required")}],children:(0,k.jsx)(c.default,{disabled:!0,className:"w-100",style:{minWidth:200}})})},"extra"+e.value))),(0,k.jsx)(d.c,{children:(0,k.jsx)(n.c.Item,{label:I("addons"),name:[l,"addons"],rules:[{required:!1,message:I("required")}],children:(0,k.jsx)(g.g,{mode:"multiple",style:{minWidth:"300px"},fetchOptions:T,allowClear:!0})})}),(0,k.jsx)(d.c,{children:(0,k.jsx)(n.c.Item,{label:I("sku"),name:[l,"sku"],children:(0,k.jsx)(o.default,{className:"w-100",style:{minWidth:200}})})}),(0,k.jsx)(d.c,{children:(0,k.jsx)(n.c.Item,{label:I("quantity"),name:[l,"quantity"],rules:[{required:!0,message:I("required")}],children:(0,k.jsx)(r.c,{min:0,className:"w-100",style:{minWidth:200}})})}),(0,k.jsxs)(d.c,{children:[(0,k.jsx)(n.c.Item,{label:"".concat(I("price")," (").concat(null===W||void 0===W?void 0:W.symbol,")"),name:[l,"price"],rules:[{required:!0,message:I("requried")}],children:(0,k.jsx)(r.c,{min:0,className:"w-100",style:{minWidth:200}})}),(0,k.jsx)(n.c.Item,{hidden:!0,label:I("id"),name:[l,"stock_id"],children:(0,k.jsx)(r.c,{min:1,className:"w-100",disabled:!0,style:{minWidth:200},addonAfter:"%"})})]}),(0,k.jsx)(d.c,{children:(0,k.jsx)(n.c.Item,{label:I("tax"),name:[l,"tax"],children:(0,k.jsx)(r.c,{className:"w-100",disabled:!0,style:{minWidth:200},addonAfter:"%"})})}),(0,k.jsx)(d.c,{children:(0,k.jsx)(n.c.Item,{noStyle:!0,shouldUpdate:(l,t)=>{var a,n;return(null===(a=l.stocks[e.name])||void 0===a?void 0:a.price)!==(null===(n=t.stocks[e.name])||void 0===n?void 0:n.price)},children:l=>{let{getFieldValue:t}=l;const a=t(["stocks",e.name,"tax"])||0,i=t(["stocks",e.name,"price"]),s=0===a?i:i*a/100+i;return(0,k.jsx)(n.c.Item,{label:"".concat(I("total.price")," (").concat(null===W||void 0===W?void 0:W.symbol,")"),children:(0,k.jsx)(r.c,{min:1,disabled:!0,value:s,className:"w-100",style:{minWidth:200}})})}})}),(0,k.jsx)(d.c,{children:e.key?(0,k.jsx)(u.c,{type:"primary",className:"mt-2",danger:!0,icon:(0,k.jsx)(p.c,{}),onClick:()=>{a(e.name)}}):""})]},e.key)}))})}}),(0,k.jsxs)(v.c,{className:"mt-4",children:[(0,k.jsx)(u.c,{onClick:t,children:I("prev")}),(0,k.jsx)(u.c,{type:"primary",htmlType:"submit",loading:!!N,children:I("next")})]})]})})}},68648:(e,l,t)=>{t.d(l,{c:()=>_});var a=t(99584),n=t(65732),i=t(68768),s=t(10260),d=t(68496),c=t(46712),o=t(10240),r=t(26012),u=t(87228),v=t(71376),m=t(48820),p=t(12636),h=t(75808),x=t(32712),j=t(10580),g=t(18896),f=t(68408),y=t(23424),b=t(65236),k=t(40936),q=t(82168),w=t(6428),I=t(94936),S=t(84190),C=t(97884);const _=e=>{var l,t,_;let{next:N,action_type:E="",isRequest:F}=e;const{t:P}=(0,b.G)(),[G]=n.c.useForm(),O=n.c.useWatch("shop",G),M=(0,x.OY)(),{uuid:L}=(0,y.W4)(),V=(0,y.i6)(),[W,T]=(0,a.useState)(null),{activeMenu:A}=(0,x.w1)((e=>e.menu),x.G),{defaultLang:Y,languages:H}=(0,x.w1)((e=>e.formLang),x.G),[z,B]=(0,a.useState)(null!==(l=A.data)&&void 0!==l&&l.images?null===(t=A.data)||void 0===t?void 0:t.images:[]),[R,D]=(0,a.useState)(!1),[U,K]=(0,a.useState)([]),[X,J]=(0,a.useState)(Boolean(null===(_=A.data)||void 0===_?void 0:_.kcal));(0,a.useEffect)((()=>{const e=G.getFieldsValue(!0);M((0,g.MH)({activeMenu:A,data:{...A.data,...e}}))}),[]);function Q(e){const l={perPage:10,page:1,active:1,search:e};return f.c.getAll(l).then((e=>{let{data:l}=e;return K(function(e){return e.map((e=>{var l;return{label:null===(l=e.translation)||void 0===l?void 0:l.title,value:e.id}}))}(l)),null===l||void 0===l?void 0:l.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id}}))}))}(0,a.useEffect)((()=>{Q()}),[]);const Z=()=>{M((0,g.WC)({id:"category-add",url:"category/add",name:P("add.category")})),V("/category/add")};return(0,C.jsxs)(n.c,{layout:"vertical",form:G,initialValues:{active:!0,vegetarian:!0,...A.data},onFinish:e=>{var l,t,a,n;D(!0);const i={...e,active:Number(e.active),vegetarian:Number(e.vegetarian),brand_id:null===(l=e.brand)||void 0===l?void 0:l.value,category_id:(null===(t=e.category)||void 0===t?void 0:t.value)||e.category,shop_id:null===(a=e.shop)||void 0===a?void 0:a.value,unit_id:null===(n=e.unit)||void 0===n?void 0:n.value,kcal:X?String(e.kcal):void 0,carbs:X?String(e.carbs):void 0,protein:X?String(e.protein):void 0,fats:X?String(e.fats):void 0,images:void 0,brand:void 0,category:void 0,shop:void 0,unit:void 0,tax:e.tax||0,...Object.assign({},...z.map(((e,l)=>({["images[".concat(l,"]")]:e.name}))))};if(F)return M((0,g.MH)({activeMenu:A,data:{...A.data,...i,images:z,brand:e.brand,category:e.category,shop:e.shop,unit:e.unit,tax:e.tax||0,title:{...Object.assign({},...H.map((l=>({[l.locale]:e["title[".concat(l.locale,"]")]}))))},description:{...Object.assign({},...H.map((l=>({[l.locale]:e["description[".concat(l.locale,"]")]}))))}}})),void N();"edit"===E?function(e,l){j.c.update(L,l).then((()=>{M((0,g.MH)({activeMenu:A,data:{...e,...null===A||void 0===A?void 0:A.data}})),N()})).catch((e=>T(e.response.data.params))).finally((()=>D(!1)))}(e,i):function(e,l){j.c.create(l).then((l=>{let{data:t}=l;M((0,g.Ke)({id:"product-".concat(t.uuid),url:"product/".concat(t.uuid),name:P("add.product"),data:e,refetch:!1})),V("/product/".concat(t.uuid,"/?step=1"))})).catch((e=>T(e.response.data.params))).finally((()=>D(!1)))}(e,i)},children:[(0,C.jsxs)(i.c,{gutter:12,children:[(0,C.jsx)(s.c,{span:16,children:(0,C.jsxs)(i.c,{children:[(0,C.jsx)(s.c,{span:24,children:(0,C.jsx)(d.default,{title:P("basic.info"),children:(0,C.jsxs)(i.c,{children:[(0,C.jsx)(s.c,{span:24,children:H.map((e=>(0,C.jsx)(n.c.Item,{label:P("name"),name:"title[".concat(e.locale,"]"),rules:[{validator:(l,t)=>t||(null===e||void 0===e?void 0:e.locale)!==Y?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(P("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(P("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(P("required")))}],hidden:e.locale!==Y,children:(0,C.jsx)(c.default,{})},"name"+e.id)))}),(0,C.jsx)(s.c,{span:24,children:H.map((e=>(0,C.jsx)(n.c.Item,{label:P("description"),name:"description[".concat(e.locale,"]"),rules:[{validator:(l,t)=>t||(null===e||void 0===e?void 0:e.locale)!==Y?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(P("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<5?Promise.reject(new Error(P("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(P("required")))}],hidden:e.locale!==Y,children:(0,C.jsx)(q.c,{rows:3})},"description"+e.id)))})]})})}),(0,C.jsx)(s.c,{span:24,children:(0,C.jsx)(d.default,{title:P("pricing"),children:(0,C.jsxs)(i.c,{gutter:12,children:[(0,C.jsx)(s.c,{span:6,children:(0,C.jsx)(n.c.Item,{label:P("min.qty"),name:"min_qty",rules:[{required:!0,message:P("required")}],children:(0,C.jsx)(o.c,{min:0,className:"w-100"})})}),(0,C.jsx)(s.c,{span:6,children:(0,C.jsx)(n.c.Item,{label:P("max.qty"),name:"max_qty",rules:[{required:!0,message:P("required")}],children:(0,C.jsx)(o.c,{min:0,className:"w-100"})})}),(0,C.jsx)(s.c,{span:6,children:(0,C.jsx)(n.c.Item,{label:P("tax"),name:"tax",rules:[{validator:(e,l)=>l&&(l<0||l>100)?Promise.reject(new Error(P("must.be.between.0.and.100"))):Promise.resolve()}],children:(0,C.jsx)(o.c,{className:"w-100",addonAfter:"%"})})}),(0,C.jsx)(s.c,{span:6,children:(0,C.jsx)(n.c.Item,{label:P("interval.unit"),name:"interval",rules:[{required:!0,message:P("required")},{type:"number",min:0,message:P("must.be.positive")}],help:null!==W&&void 0!==W&&W.interval?W.interval[0]:null,validateStatus:null!==W&&void 0!==W&&W.interval?"error":"success",children:(0,C.jsx)(o.c,{className:"w-100"})})})]})})}),(0,C.jsx)(s.c,{span:24,children:(0,C.jsx)(d.default,{title:P("additions"),children:(0,C.jsxs)(i.c,{gutter:12,children:[(0,C.jsx)(s.c,{span:6,children:(0,C.jsx)(n.c.Item,{label:P("active"),name:"active",valuePropName:"checked",children:(0,C.jsx)(r.c,{})})}),(0,C.jsx)(s.c,{span:6,children:(0,C.jsx)(n.c.Item,{label:P("vegetarian"),name:"vegetarian",valuePropName:"checked",children:(0,C.jsx)(r.c,{})})}),(0,C.jsx)(s.c,{span:6,children:(0,C.jsx)(n.c.Item,{label:P("nutrition.".concat(X?"on":"off")),valuePropName:"checked",children:(0,C.jsx)(r.c,{checked:X,onChange:e=>J(e)})})})]})})}),X&&(0,C.jsx)(s.c,{span:24,children:(0,C.jsx)(d.default,{title:P("nutritional.value.of.product"),children:(0,C.jsxs)(i.c,{gutter:12,children:[(0,C.jsx)(s.c,{span:6,children:(0,C.jsx)(n.c.Item,{rules:[{required:!0,message:P("required")}],label:P("kcal"),name:"kcal",children:(0,C.jsx)(o.c,{min:0,max:10,className:"w-100"})})}),(0,C.jsx)(s.c,{span:6,children:(0,C.jsx)(n.c.Item,{rules:[{required:!0,message:P("required")}],label:P("carbs"),name:"carbs",children:(0,C.jsx)(o.c,{min:0,max:10,className:"w-100"})})}),(0,C.jsx)(s.c,{span:6,children:(0,C.jsx)(n.c.Item,{rules:[{required:!0,message:P("required")}],label:P("protein"),name:"protein",children:(0,C.jsx)(o.c,{min:0,max:10,className:"w-100"})})}),(0,C.jsx)(s.c,{span:6,children:(0,C.jsx)(n.c.Item,{rules:[{required:!0,message:P("required")}],label:P("fats"),name:"fats",children:(0,C.jsx)(o.c,{min:0,max:10,className:"w-100"})})})]})})})]})}),(0,C.jsx)(s.c,{span:8,children:(0,C.jsxs)(i.c,{children:[(0,C.jsx)(s.c,{span:24,children:(0,C.jsx)(d.default,{title:P("organization"),children:(0,C.jsxs)(i.c,{children:[!F&&(0,C.jsx)(s.c,{span:24,children:(0,C.jsx)(n.c.Item,{label:P("shop/restaurant"),name:"shop",rules:[{required:!0,message:P("required")}],children:(0,C.jsx)(w.u,{fetchOptions:async function(e){const l={search:e,active:1};return m.c.get(l).then((e=>e.data.map((e=>({label:e.translation?e.translation.title:"no name",value:e.id})))))},onChange:()=>G.setFieldsValue({category:void 0})})})}),(0,C.jsx)(s.c,{span:24,children:(0,C.jsx)(n.c.Item,{label:P("category"),name:"category",rules:[{required:!0,message:P("required")}],children:(0,C.jsx)(S.u,{disabled:!(null!==O&&void 0!==O&&O.value),refetch:!0,fetchOptions:async function(e){const l={perPage:10,type:"main",search:e,shop_id:null===O||void 0===O?void 0:O.value,"statuses[0]":"pending","statuses[1]":"published",active:1};return h.c.selectPaginate(l).then((e=>e.data.map((e=>{var l,t;return{label:(null===(l=e.translation)||void 0===l?void 0:l.title)||"",value:e.id,key:e.id,disabled:e.children.length>0,children:null===(t=e.children)||void 0===t?void 0:t.map((e=>{var l;return{label:(null===(l=e.translation)||void 0===l?void 0:l.title)||"",value:e.id,key:e.id}}))}}))))},dropdownRender:e=>(0,C.jsxs)(C.Fragment,{children:[e,(0,C.jsx)("div",{className:"p-1",children:(0,C.jsx)(u.c,{icon:(0,C.jsx)(I.c,{}),className:"w-100",onClick:Z,children:P("add.category")})})]})})})}),(0,C.jsx)(s.c,{span:24,children:(0,C.jsx)(n.c.Item,{label:P("brand"),name:"brand",children:(0,C.jsx)(v.g,{fetchOptions:async function(e){const l={perPage:10,type:"main",search:e,active:1};return p.c.getAll(l).then((e=>e.data.map((e=>({label:e.title,value:e.id})))))}})})}),(0,C.jsx)(s.c,{span:24,children:(0,C.jsx)(n.c.Item,{label:P("unit"),name:"unit",rules:[{required:!0,message:P("required")}],children:(0,C.jsx)(v.g,{fetchOptions:Q})})}),(0,C.jsx)(s.c,{span:24,children:(0,C.jsx)(n.c.Item,{label:P("sku"),name:"sku",children:(0,C.jsx)(c.default,{className:"w-100"})})})]})})}),(0,C.jsx)(s.c,{span:24,children:(0,C.jsx)(d.default,{title:P("media"),children:(0,C.jsx)(i.c,{children:(0,C.jsx)(s.c,{span:24,children:(0,C.jsx)(n.c.Item,{name:"images",rules:[{validator:(e,l)=>0===z.length?Promise.reject(new Error(P("required"))):Promise.resolve()}],children:(0,C.jsx)(k.c,{type:"products",imageList:z,setImageList:B,form:G,multiple:!0})})})})})})]})})]}),(0,C.jsx)(u.c,{type:"primary",htmlType:"submit",loading:R,children:P("next")})]})}},22112:(e,l,t)=>{t.d(l,{C:()=>a});const a=[{title:"product",content:"First-content"},{title:"product.extras",content:"Second-content"},{title:"stocks",content:"Third-content"},{title:"product.property",content:"Fourth-content"},{title:"finish",content:"Finish-content"}]}}]);