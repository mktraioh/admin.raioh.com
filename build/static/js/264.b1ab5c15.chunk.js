"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[264],{50264:(t,e,i)=>{i.r(e),i.d(e,{default:()=>b});var a=i(99584),n=i(23424),l=i(61072),s=i(67692),c=i(65732),o=i(68496),r=i(37728),d=i(52640),u=i(32712),g=i(18896),m=i(65236),v=i(424),p=i(16488),h=i(28716),f=i(97884);const{Step:_}=s.default,b=()=>{var t,e,i;const{t:b}=(0,m.G)(),{activeMenu:y}=(0,u.w1)((t=>t.menu),u.G),{id:j}=(0,n.W4)(),x=(0,u.OY)(),{defaultLang:k,languages:S}=(0,u.w1)((t=>t.formLang),u.G),[w,N]=(0,a.useState)((null===(t=y.data)||void 0===t?void 0:t.step)||0),[F,C]=(0,a.useState)(null!==(e=y.data)&&void 0!==e&&e.image?[null===(i=y.data)||void 0===i?void 0:i.image]:[]),M=()=>{N(w+1)},O=()=>{N(w-1)},[G]=c.c.useForm(),V=(0,n.i6)(),[q,E]=(0,a.useState)(!1),[I,L]=(0,a.useState)(!1);(0,a.useEffect)((()=>()=>{const t=G.getFieldsValue(!0);x((0,g.MH)({activeMenu:y,data:t}))}),[]);return(0,a.useEffect)((()=>{y.refetch&&(t=>{E(!0),h.c.getById(t).then((t=>{var e;let i=t.data;var a;console.log("recept",i),G.setFieldsValue({...i,active_time:Number(i.active_time),total_time:Number(i.total_time),title:{[k]:i.translation.title},description:{[k]:i.translation.description},instruction:Object.assign({},...i.instructions.map((t=>({[t.locale]:t.title})))),ingredient:Object.assign({},...i.ingredients.map((t=>({[t.locale]:t.title})))),nutrition:null===(e=i.nutritions)||void 0===e?void 0:e.map((t=>({percentage:Number(null===t||void 0===t?void 0:t.percentage),weight:Number(null===t||void 0===t?void 0:t.weight),...Object.assign({},...t.translations.flatMap((t=>({[t.locale]:t.title}))))}))),category_id:{value:i.category.id,label:i.category.translation.title},stocks:i.stocks.map((t=>({stock_id:{value:t.id,label:t.product.translation.title},...t})))}),C([(a=i.img,{name:a,url:d.cd+a})])})).finally((()=>{E(!1),x((0,g.CO)(y))}))})(j)}),[y.refetch]),(0,f.jsx)(o.default,{title:b("edit.recepe"),extra:(0,f.jsx)(v.c,{}),children:q?(0,f.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,f.jsx)(r.c,{size:"large",className:"py-5"})}):(0,f.jsxs)(c.c,{layout:"vertical",onFinish:t=>{var e;G.validateFields();const i={...t,total_time:t.total_time.toString(),active_time:t.active_time.toString(),category_id:t.category_id.value,images:null===F||void 0===F?void 0:F.map((t=>t.name)),stocks:t.stocks.map((t=>({min_quantity:t.min_quantity,stock_id:t.stock_id.value}))),nutrition:null===(e=t.nutrition)||void 0===e?void 0:e.map((t=>{var e;return{...t,percentage:null===t||void 0===t||null===(e=t.percentage)||void 0===e?void 0:e.toString(),weight:t.weight.toString()}}))};L(!0);const a="seller/recept";h.c.update(j,i).then((()=>{l.m4.success(b("successfully.updated")),V("/".concat(a)),x((0,g.MF)({...y,nextUrl:a}))})).finally((()=>L(!1)))},form:G,initialValues:{active:!0,...y.data},children:[(0,f.jsx)(s.default,{current:w,children:p.C.map((t=>(0,f.jsx)(_,{title:b(t.title)},t.title)))}),p.C.map((t=>{const e=t.content;return(0,f.jsx)("div",{className:"steps-content ".concat(t.step!==w+1&&"hidden"),children:(0,f.jsx)(e,{next:M,prev:O,loading:I,image:F,setImage:C})},t.title)}))]})})}}}]);