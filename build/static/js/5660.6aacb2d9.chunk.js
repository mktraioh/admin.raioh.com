"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[5660],{71376:(e,t,a)=>{a.d(t,{g:()=>u});var s=a(99584),l=a(95976),n=a.n(l),d=a(2664),r=a(37728),i=a(97884);const u=e=>{let{fetchOptions:t,debounceTimeout:a=400,onClear:l,...u}=e;const[c,o]=(0,s.useState)(!1),[m,h]=(0,s.useState)([]),p=(0,s.useMemo)((()=>n()((e=>{h([]),o(!0),t(e).then((e=>{h(e),o(!1)}))}),a)),[t,a]);return(0,i.jsx)(d.default,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:p,onClear:()=>{p(""),l&&l()},notFoundContent:c?(0,i.jsx)(r.c,{size:"small"}):"no results",...u,options:m,onFocus:()=>{p("")}})}},45660:(e,t,a)=>{a.r(t),a.d(t,{default:()=>j});var s=a(99584),l=a(23424),n=a(61072),d=a(65732),r=a(68496),i=a(83072),u=a.n(i),c=a(32712),o=a(18896),m=a(85912),h=a(26744),p=a(65236),v=a(49580),f=a(77180),x=a(27632),Y=a(97884);function j(){const{t:e}=(0,p.G)(),{activeMenu:t}=(0,c.w1)((e=>e.menu),c.G),a=(0,c.OY)(),{id:i}=(0,l.W4)(),[j]=d.c.useForm(),g=(0,l.i6)(),[b,M]=(0,s.useState)(!1);(0,s.useEffect)((()=>()=>{const e=j.getFieldsValue(!0),s=JSON.stringify(e.start),l=JSON.stringify(e.end),n={...e,start:s,end:l};a((0,o.MH)({activeMenu:t,data:n}))}),[]),(0,s.useEffect)((()=>{t.refetch&&(M(!0),m.c.getById(i).then((e=>{let{data:s}=e;const l={price:null===s||void 0===s?void 0:s.price,type:null===s||void 0===s?void 0:s.type,products:null===s||void 0===s?void 0:s.products.map((e=>{var t;return{label:null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title,value:null===e||void 0===e?void 0:e.id}})),start:u()(null===s||void 0===s?void 0:s.start,"YYYY-MM-DD"),end:u()(null===s||void 0===s?void 0:s.end,"YYYY-MM-DD"),image:[(0,v.c)(null===s||void 0===s?void 0:s.img)]};j.setFieldsValue(l),a((0,o.MH)({activeMenu:t,data:{...l,start:null===s||void 0===s?void 0:s.start,end:null===s||void 0===s?void 0:s.end}}))})).finally((()=>{M(!1),a((0,o.CO)(t))})))}),[t.refetch]);return(0,Y.jsx)(r.default,{title:e("edit.discount"),className:"h-100",children:b?(0,Y.jsx)(f.c,{}):(0,Y.jsx)(x.c,{form:j,handleSubmit:(s,l)=>{var d;if(u()(s.start).format("YYYY-MM-DD")>u()(s.end).format("YYYY-MM-DD"))return n.m4.error(e("start.date.must.be.before.end.date"));const r={price:s.price,type:s.type,products:s.products.map((e=>e.value)),start:s.start?u()(s.start).format("YYYY-MM-DD"):void 0,end:s.end?u()(s.end).format("YYYY-MM-DD"):void 0,images:[null===(d=l[0])||void 0===d?void 0:d.name]},p="seller/discounts";return m.c.update(i,r).then((()=>{n.m4.success(e("successfully.updated")),(0,c.wN)((()=>{a((0,o.MF)({...t,nextUrl:p})),a((0,h._)({}))})),g("/".concat(p))}))}})})}},27632:(e,t,a)=>{a.d(t,{c:()=>j});var s=a(99584),l=a(65732),n=a(68768),d=a(10260),r=a(2664),i=a(10240),u=a(73568),c=a(87228),o=a(83072),m=a.n(o),h=a(71376),p=a(40936),v=a(65236),f=a(32712),x=a(31e3),Y=a(97884);function j(e){var t,a;let{form:o,handleSubmit:j}=e;const{t:g}=(0,v.G)(),{activeMenu:b}=(0,f.w1)((e=>e.menu),f.G),{myShop:M}=(0,f.w1)((e=>e.myShop),f.G),[y,D]=(0,s.useState)(!1),[S,q]=(0,s.useState)(null!==(t=b.data)&&void 0!==t&&t.image?null===(a=b.data)||void 0===a?void 0:a.image:[]);return(0,Y.jsxs)(l.c,{name:"discount-form",layout:"vertical",onFinish:e=>{D(!0),j(e,S).finally((()=>D(!1)))},form:o,initialValues:{...(()=>{var e;const t=b.data;if(null===(e=b.data)||void 0===e||!e.start)return t;const a=b.data.start,s=b.data.end;return{...t,start:m()(a,"YYYY-MM-DD"),end:m()(s,"YYYY-MM-DD")}})()},className:"d-flex flex-column h-100",children:[(0,Y.jsxs)(n.c,{gutter:12,children:[(0,Y.jsx)(d.c,{span:12,children:(0,Y.jsx)(l.c.Item,{label:g("type"),name:"type",rules:[{required:!0,message:g("required")}],children:(0,Y.jsxs)(r.default,{children:[(0,Y.jsx)(r.default.Option,{value:"fix",children:g("fix")}),(0,Y.jsx)(r.default.Option,{value:"percent",children:g("percent")})]})})}),(0,Y.jsx)(d.c,{span:12,children:(0,Y.jsx)(l.c.Item,{label:g("price"),name:"price",rules:[{required:!0,message:g("required")}],children:(0,Y.jsx)(i.c,{min:0,className:"w-100"})})}),(0,Y.jsx)(d.c,{span:12,children:(0,Y.jsx)(l.c.Item,{label:g("start.date"),name:"start",rules:[{required:!0,message:g("required")}],children:(0,Y.jsx)(u.default,{className:"w-100",placeholder:"",disabledDate:e=>m()().add(-1,"days")>=e})})}),(0,Y.jsx)(d.c,{span:12,children:(0,Y.jsx)(l.c.Item,{label:g("end.date"),name:"end",rules:[{required:!0,message:g("required")}],children:(0,Y.jsx)(u.default,{className:"w-100",placeholder:"",disabledDate:e=>m()().add(-1,"days")>=e})})}),(0,Y.jsx)(d.c,{span:24,children:(0,Y.jsx)(l.c.Item,{label:g("products"),name:"products",rules:[{required:!0,message:g("required")}],children:(0,Y.jsx)(h.g,{fetchOptions:async function(e){const t={search:e,shop_id:M.id,status:"published",active:1,rest:1};return x.c.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id}}))}))},mode:"multiple"})})}),(0,Y.jsx)(d.c,{span:24,children:(0,Y.jsx)(l.c.Item,{label:g("image"),name:"images",rules:[{required:!S.length,message:g("required")}],children:(0,Y.jsx)(p.c,{type:"discounts",imageList:S,setImageList:q,form:o,multiple:!1,name:"image"})})})]}),(0,Y.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,Y.jsx)("div",{className:"pb-5",children:(0,Y.jsx)(c.c,{type:"primary",htmlType:"submit",loading:y,children:g("submit")})})})]})}}}]);