"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[792],{10792:(t,e,a)=>{a.r(e),a.d(e,{default:()=>y});var i=a(99584),l=a(23424),n=a(61072),s=a(67692),c=a(65732),o=a(68496),r=a(37728),d=a(52640),u=a(32712),g=a(18896),v=a(65236),p=a(424),h=a(70424),m=a(94792),f=a(97884);const{Step:_}=s.default,y=()=>{var t,e,a;const{t:y}=(0,v.G)(),{activeMenu:b}=(0,u.w1)((t=>t.menu),u.G),{id:j}=(0,l.W4)(),k=(0,u.OY)(),{defaultLang:x}=(0,u.w1)((t=>t.formLang),u.G),[S,w]=(0,i.useState)((null===(t=b.data)||void 0===t?void 0:t.step)||0),F=t=>({name:t,url:d.cd+t}),[C,M]=(0,i.useState)(null!==(e=b.data)&&void 0!==e&&e.galleries[0]?[F(b.data.galleries[0].path)]:[]),[O,G]=(0,i.useState)(null!==(a=b.data)&&void 0!==a&&a.galleries[1]?[F(b.data.galleries[1].path)]:[]),N=()=>{w(S+1)},V=()=>{w(S-1)},[q]=c.c.useForm(),B=(0,l.i6)(),[E,I]=(0,i.useState)(!1),[L,z]=(0,i.useState)(!1);(0,i.useEffect)((()=>()=>{const t=q.getFieldsValue(!0);k((0,g.MH)({activeMenu:b,data:t}))}),[]);const H=[...C,...O];return(0,i.useEffect)((()=>{b.refetch&&(t=>{I(!0),m.c.getById(t).then((t=>{var e,a,i;let l=t.data;q.setFieldsValue({...l,title:{[x]:l.translation.title},description:{[x]:l.translation.description},instruction:Object.assign({},...l.instructions.map((t=>({[t.locale]:t.title})))),ingredient:Object.assign({},...l.ingredients.map((t=>({[t.locale]:t.title})))),nutrition:null===(e=l.nutritions)||void 0===e?void 0:e.map((t=>{var e;return{percentage:null===t||void 0===t||null===(e=t.percentage)||void 0===e?void 0:e.toString(),weight:t.weight,...Object.assign({},...t.translations.flatMap((t=>({[t.locale]:t.title}))))}})),category_id:{value:l.category.id,label:null===(a=l.category.translation)||void 0===a?void 0:a.title},shop_id:{value:l.shop.id,label:null===(i=l.shop.translation)||void 0===i?void 0:i.title},stocks:l.stocks.map((t=>{var e,a;return{stock_id:{value:t.id,label:null===t||void 0===t||null===(e=t.product)||void 0===e||null===(a=e.translation)||void 0===a?void 0:a.title},...t}}))}),M([F(l.galleries[0].path)]),G([F(l.galleries[1].path)])})).finally((()=>{I(!1),k((0,g.CO)(b))}))})(j)}),[b.refetch]),(0,f.jsx)(o.default,{title:y("edit.recepe"),extra:(0,f.jsx)(p.c,{}),children:E?(0,f.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,f.jsx)(r.c,{size:"large",className:"py-5"})}):(0,f.jsxs)(c.c,{layout:"vertical",onFinish:t=>{var e;q.validateFields();const a={...t,category_id:t.category_id.value,images:H.map((t=>t.name)),shop_id:t.shop_id.value,active_time:t.active_time.toString(),total_time:t.total_time.toString(),nutrition:t.nutrition.map((t=>({...t,percentage:String(t.percentage),weight:String(t.weight)}))),stocks:null===(e=t.stocks)||void 0===e?void 0:e.map((t=>({min_quantity:t.min_quantity,stock_id:t.stock_id.value})))};z(!0);const i="catalog/recept";m.c.update(j,a).then((()=>{n.m4.success(y("successfully.updated")),B("/".concat(i)),k((0,g.MF)({...b,nextUrl:i}))})).finally((()=>z(!1)))},form:q,initialValues:{active:!0,...b.data},children:[(0,f.jsx)(s.default,{current:S,children:h.C.map((t=>(0,f.jsx)(_,{title:y(t.title)},t.title)))}),h.C.map((t=>{const e=t.content;return(0,f.jsx)("div",{className:"steps-content ".concat(t.step!==S+1&&"hidden"),children:(0,f.jsx)(e,{next:N,prev:V,loading:L,image:C,setImage:M,back:O,setBack:G})},t.title)}))]})})}}}]);