"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[1171],{24692:(e,t,s)=>{s.d(t,{o:()=>u});var a=s(99584),n=s(2664),i=s(37728),l=s(97884);const u=e=>{let{fetchOptions:t,refetch:s=!1,...u}=e;const[c,r]=(0,a.useState)(!1),[d,o]=(0,a.useState)([]);return(0,l.jsx)(n.default,{labelInValue:!0,filterOption:!1,notFoundContent:c?(0,l.jsx)(i.c,{size:"small"}):"no results",...u,options:c?[]:d,onFocus:()=>{d.length&&!s||(r(!0),t().then((e=>{o(e),r(!1)})))}})}},23552:(e,t,s)=>{s.r(t),s.d(t,{default:()=>f});var a=s(99584),n=s(23424),i=s(61072),l=s(65732),u=s(68496),c=s(32712),r=s(18896),d=s(65236),o=s(83072),m=s.n(o),p=s(64544),x=s(96156),h=s(77180),b=s(72044),v=s(97884);const f=()=>{const{t:e}=(0,d.G)(),{activeMenu:t}=(0,c.w1)((e=>e.menu),c.G),s=(0,c.OY)(),[o]=l.c.useForm(),f=(0,n.i6)(),[j,_]=(0,a.useState)(!1),{myShop:y}=(0,c.w1)((e=>e.myShop),c.G),{id:g}=(0,n.W4)();(0,a.useEffect)((()=>()=>{const e=o.getFieldsValue(!0);e.expired_at=JSON.stringify(null===e||void 0===e?void 0:e.expired_at),s((0,r.MH)({activeMenu:t,data:e}))}),[]);const S=e=>{_(!0),x.c.getById(e).then((e=>{!function(e){var a,n,i,l,u;const c={...e,expired_at:m()(e.expired_at,"YYYY-MM-DD"),bonus_stock_id:{label:(null===e||void 0===e||null===(a=e.bonusStock)||void 0===a||null===(n=a.product)||void 0===n||null===(i=n.translation)||void 0===i?void 0:i.title)+" "+(null===(l=e.bonusStock)||void 0===l?void 0:l.extras.map((e=>e.value)).join(", ")),value:null===e||void 0===e||null===(u=e.bonusStock)||void 0===u?void 0:u.id}};o.setFieldsValue({...c}),s((0,r.MH)({activeMenu:t,data:{...c,expired_at:JSON.stringify(c.expired_at)}})),_(!1)}(e.data)})).finally((()=>s((0,r.CO)(t))))};(0,a.useEffect)((()=>{t.refetch&&S(g)}),[t.refetch]);return(0,v.jsx)(u.default,{title:e("edit.bonus"),className:"h-100",children:j?(0,v.jsx)(h.c,{}):(0,v.jsx)(b.c,{form:o,handleSubmit:a=>{const n={expired_at:m()(a.expired_at).format("YYYY-MM-DD"),status:a.status,type:"sum",value:a.value,bonus_stock_id:a.bonus_stock_id.value,bonus_quantity:a.bonus_quantity,bonusable_id:y.id},l="seller/bonus/shop";return x.c.update(g,n).then((()=>{i.m4.success(e("successfully.created")),(0,c.wN)((()=>{s((0,r.MF)({...t,nextUrl:l})),s((0,p.S)({}))})),f("/".concat(l))}))}})})}},72044:(e,t,s)=>{s.d(t,{c:()=>f});var a=s(99584),n=s(65732),i=s(68768),l=s(10260),u=s(10240),c=s(73568),r=s(26012),d=s(87228),o=s(24692),m=s(83072),p=s.n(m),x=s(65236),h=s(32712),b=s(31e3),v=s(97884);function f(e){let{form:t,handleSubmit:s}=e;const{t:m}=(0,x.G)(),{activeMenu:f}=(0,h.w1)((e=>e.menu),h.G),[j,_]=(0,a.useState)(!1);return(0,v.jsxs)(n.c,{name:"bonus-form",layout:"vertical",onFinish:e=>{_(!0),s(e).finally((()=>_(!1)))},form:t,initialValues:{status:!0,...f.data,...(()=>{var e,t;if(null===(e=f.data)||void 0===e||!e.expired_at)return{};const s=JSON.parse(null===(t=f.data)||void 0===t?void 0:t.expired_at);return{expired_at:p()(s,"HH:mm:ss")}})()},className:"d-flex flex-column h-100",children:[(0,v.jsxs)(i.c,{gutter:12,children:[(0,v.jsx)(l.c,{span:12,children:(0,v.jsx)(n.c.Item,{label:m("order_amount"),name:"value",rules:[{required:!0,message:m("required")},{type:"number",min:1,message:m("min.1")}],children:(0,v.jsx)(u.c,{className:"w-100"})})}),(0,v.jsx)(l.c,{span:12,children:(0,v.jsx)(n.c.Item,{label:m("bonus.product.stock"),name:"bonus_stock_id",rules:[{required:!0,message:m("required")}],children:(0,v.jsx)(o.o,{fetchOptions:function(){return b.c.getStock({active:1,status:"published"}).then((e=>e.data.map((e=>({label:e.product.translation.title+"".concat(e.extras.length>0?": ".concat(e.extras.map((e=>e.value)).join(", ")):""),value:e.id})))))},debounceTimeout:200})})}),(0,v.jsx)(l.c,{span:12,children:(0,v.jsx)(n.c.Item,{label:m("bonus.product.quantity"),name:"bonus_quantity",rules:[{required:!0,message:m("required")},{type:"number",min:1,message:m("min.1")}],children:(0,v.jsx)(u.c,{className:"w-100"})})}),(0,v.jsx)(l.c,{span:12,children:(0,v.jsx)(n.c.Item,{name:"expired_at",label:m("expired.at"),rules:[{required:!0,message:m("required")}],children:(0,v.jsx)(c.default,{className:"w-100",placeholder:"",disabledDate:e=>p()().add(-1,"days")>=e})})}),(0,v.jsx)(l.c,{span:12,children:(0,v.jsx)(n.c.Item,{label:m("active"),name:"status",valuePropName:"checked",children:(0,v.jsx)(r.c,{})})})]}),(0,v.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,v.jsx)("div",{className:"pb-5",children:(0,v.jsx)(d.c,{type:"primary",htmlType:"submit",loading:j,children:m("submit")})})})]})}}}]);