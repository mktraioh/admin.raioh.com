"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[8437],{88276:(e,t,a)=>{a.d(t,{c:()=>D});var s=a(99584),l=a(65732),n=a(66296),i=a(87228),r=a(23424),d=a(68768),c=a(10260),o=a(68496),u=a(46712),m=a(26012),g=a(10240),h=a(50452),x=a(2664),p=a(64212),j=a(42080),v=a(32712),f=a(65236),y=a(75808),b=a(89896),_=a(34560),q=a(52640),I=a(97884);function w(e){let{setLocation:t,form:a,item:s,idx:n,defaultLang:i}=e;const{t:r}=(0,f.G)(),{google_map_key:d}=(0,v.w1)((e=>e.globalSettings.settings),v.G),{ref:c}=(0,_.usePlacesWidget)({apiKey:d||q.KU,onPlaceSelected:e=>{const s={lat:null===e||void 0===e?void 0:e.geometry.location.lat(),lng:null===e||void 0===e?void 0:e.geometry.location.lng()};t(s),a.setFieldsValue({["address[".concat(i,"]")]:null===e||void 0===e?void 0:e.formatted_address})}});return(0,I.jsx)(l.c.Item,{label:r("address"),name:"address[".concat(null===s||void 0===s?void 0:s.locale,"]"),rules:[{required:(null===s||void 0===s?void 0:s.locale)===i,message:r("required")}],hidden:(null===s||void 0===s?void 0:s.locale)!==i,children:(0,I.jsx)("input",{className:"address-input",ref:c,placeholder:""})},"address"+n)}var k=a(40936),S=a(24332),F=a(84640),L=a(2340),N=a(6428),H=a(21984);const M=e=>{let{logoImage:t,setLogoImage:a,backImage:n,setBackImage:r,form:_,location:q,setLocation:M,user:G}=e;const{t:Y}=(0,f.G)(),[O,D]=(0,s.useState)(null),[A,B]=(0,s.useState)(null),[C,V]=(0,s.useState)(null),{defaultLang:K,languages:P}=(0,v.w1)((e=>e.formLang),v.G);const T=()=>{D(!0),V(!0)},W=()=>{B(!0),V(!0)},E=()=>{D(!1),B(!1)};return(0,I.jsxs)(d.c,{gutter:12,children:[(0,I.jsx)(c.c,{span:24,children:(0,I.jsx)(o.default,{children:(0,I.jsxs)(d.c,{gutter:12,children:[(0,I.jsx)(c.c,{span:4,children:(0,I.jsx)(l.c.Item,{label:Y("logo.image"),children:(0,I.jsx)(k.c,{type:"shops/logo",imageList:t,setImageList:a,form:_,multiple:!1,name:"logo_img"})})}),(0,I.jsx)(c.c,{span:4,children:(0,I.jsx)(l.c.Item,{label:Y("background.image"),children:(0,I.jsx)(k.c,{type:"shops/background",imageList:n,setImageList:r,form:_,multiple:!1,name:"background_img"})})}),(0,I.jsx)(c.c,{span:10,children:(0,I.jsx)(l.c.Item,{label:Y("status.note"),name:"status_note",children:(0,I.jsx)(p.c,{rows:4})})}),(0,I.jsx)(c.c,{span:4,children:(0,I.jsx)(l.c.Item,{name:"status",label:Y("status"),children:(0,I.jsx)(u.default,{disabled:!0})})}),(0,I.jsx)(c.c,{span:2,children:(0,I.jsx)(l.c.Item,{label:Y("open"),name:"open",valuePropName:"checked",children:(0,I.jsx)(m.c,{disabled:!0})})})]})})}),(0,I.jsx)(c.c,{span:24,children:(0,I.jsx)(o.default,{title:Y("general"),children:(0,I.jsxs)(d.c,{gutter:12,children:[(0,I.jsx)(c.c,{span:12,children:(0,I.jsxs)(d.c,{gutter:12,children:[(0,I.jsx)(c.c,{span:24,children:P.map(((e,t)=>(0,I.jsx)(l.c.Item,{label:Y("title"),name:"title[".concat(e.locale,"]"),rules:[{required:e.locale===K,message:Y("required")},{min:2,message:Y("title.required")}],hidden:e.locale!==K,children:(0,I.jsx)(u.default,{})},"title"+t)))}),(0,I.jsx)(c.c,{span:24,children:(0,I.jsx)(l.c.Item,{label:Y("phone"),name:"phone",rules:[{required:!0,message:Y("required")}],children:(0,I.jsx)(g.c,{min:0,className:"w-100"})})})]})}),(0,I.jsx)(c.c,{span:12,children:P.map(((e,t)=>(0,I.jsx)(l.c.Item,{label:Y("description"),name:"description[".concat(e.locale,"]"),rules:[{required:e.locale===K,message:Y("required")},{min:3,message:Y("required")}],hidden:e.locale!==K,children:(0,I.jsx)(p.c,{rows:4})},"desc"+t)))}),(0,I.jsx)(c.c,{span:8,children:(0,I.jsx)(l.c.Item,{label:Y("restaurant.tags"),name:"tags",rules:[{required:!1,message:Y("required")}],children:(0,I.jsx)(N.u,{mode:"multiple",fetchOptions:async function(e){V(!1);const t={search:e};return H.c.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t;return{label:(null===(t=e.translation)||void 0===t?void 0:t.title)||"no name",value:e.id}}))}))},refetch:C})})}),(0,I.jsx)(c.c,{span:8,children:(0,I.jsx)(l.c.Item,{label:Y("seller"),name:"user",rules:[{required:!0,message:Y("required")}],children:(0,I.jsx)(N.u,{disabled:G,fetchOptions:async function(e){const t={search:e,roles:"user","empty-shop":1};return V(!1),j.c.search(t).then((e=>e.data.map((e=>({label:e.firstname+" "+(e.lastname?e.lastname:""),value:e.id})))))},refetch:C,dropdownRender:e=>(0,I.jsxs)(I.Fragment,{children:[e,(0,I.jsx)(h.c,{style:{margin:"8px 0"}}),(0,I.jsx)(i.c,{className:"w-100",disabled:G,icon:(0,I.jsx)(S.c,{}),onClick:T,children:Y("add.user")})]})})})}),(0,I.jsx)(c.c,{span:8,children:(0,I.jsx)(l.c.Item,{label:Y("categories"),name:"categories",rules:[{required:!0,message:Y("required")}],children:(0,I.jsx)(N.u,{mode:"multiple",fetchOptions:async function(e){const t={search:e,type:"shop"};return V(!1),y.c.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t;return{label:(null===(t=e.translation)||void 0===t?void 0:t.title)||"no name",value:e.id}}))}))},refetch:C,dropdownRender:e=>(0,I.jsxs)(I.Fragment,{children:[e,(0,I.jsx)(h.c,{style:{margin:"8px 0"}}),(0,I.jsx)(i.c,{className:"w-100",icon:(0,I.jsx)(S.c,{}),onClick:W,children:Y("add.category")})]})})})})]})})}),(0,I.jsx)(c.c,{span:8,children:(0,I.jsx)(o.default,{title:Y("delivery"),children:(0,I.jsxs)(d.c,{gutter:8,children:[(0,I.jsx)(c.c,{span:12,children:(0,I.jsx)(l.c.Item,{name:"price",label:Y("min.price"),rules:[{required:!0,message:Y("required")}],children:(0,I.jsx)(g.c,{className:"w-100"})})}),(0,I.jsx)(c.c,{span:12,children:(0,I.jsx)(l.c.Item,{name:"price_per_km",label:Y("price.per.km"),rules:[{required:!0,message:Y("required")}],children:(0,I.jsx)(g.c,{className:"w-100"})})})]})})}),(0,I.jsx)(c.c,{span:8,children:(0,I.jsx)(o.default,{title:Y("delivery.time"),children:(0,I.jsxs)(d.c,{gutter:12,children:[(0,I.jsx)(c.c,{span:12,children:(0,I.jsx)(l.c.Item,{name:"delivery_time_type",label:Y("delivery_time_type"),rules:[{required:!0,message:Y("required")}],children:(0,I.jsxs)(x.default,{className:"w-100",children:[(0,I.jsx)(x.default.Option,{value:"minute",label:Y("minutes")}),(0,I.jsx)(x.default.Option,{value:"hour",label:Y("hour")})]})})}),(0,I.jsx)(c.c,{span:12,children:(0,I.jsx)(l.c.Item,{name:"delivery_time_from",label:Y("delivery_time_from"),rules:[{required:!0,message:Y("required")}],children:(0,I.jsx)(g.c,{className:"w-100"})})}),(0,I.jsx)(c.c,{span:12,children:(0,I.jsx)(l.c.Item,{name:"delivery_time_to",label:Y("delivery_time_to"),rules:[{required:!0,message:Y("required")}],children:(0,I.jsx)(g.c,{className:"w-100"})})})]})})}),(0,I.jsx)(c.c,{span:8,children:(0,I.jsx)(o.default,{title:Y("order.info"),children:(0,I.jsxs)(d.c,{gutter:12,children:[(0,I.jsx)(c.c,{span:12,children:(0,I.jsx)(l.c.Item,{label:Y("min.amount"),name:"min_amount",rules:[{required:!0,message:Y("required")}],children:(0,I.jsx)(g.c,{min:0,className:"w-100"})})}),(0,I.jsx)(c.c,{span:12,children:(0,I.jsx)(l.c.Item,{label:Y("tax"),name:"tax",rules:[{required:!0,message:Y("required")}],children:(0,I.jsx)(g.c,{min:0,addonAfter:"%",className:"w-100"})})}),(0,I.jsx)(c.c,{span:12,children:(0,I.jsx)(l.c.Item,{label:Y("admin.comission"),name:"percentage",rules:[{required:!0,message:Y("required")}],children:(0,I.jsx)(g.c,{min:0,className:"w-100",addonAfter:"%"})})})]})})}),(0,I.jsx)(c.c,{span:24,children:(0,I.jsx)(o.default,{title:Y("address"),children:(0,I.jsxs)(d.c,{gutter:12,children:[(0,I.jsx)(c.c,{span:12,children:P.map(((e,t)=>(0,I.jsx)(w,{setLocation:M,form:_,item:e,idx:t,defaultLang:K},t)))}),(0,I.jsx)(c.c,{span:24,children:(0,I.jsx)(b.c,{location:q,setLocation:M,setAddress:e=>_.setFieldsValue({["address[".concat(K,"]")]:e})})})]})})}),O&&(0,I.jsx)(F.c,{visible:O,handleCancel:()=>E()}),A&&(0,I.jsx)(L.c,{visible:A,handleCancel:()=>E()})]})};var G=a(18896),Y=a(48820),O=a(33131);const D=e=>{var t,a,d,c,o,u,m,g,h;let{next:x,action_type:p="",user:j}=e;const{t:y}=(0,f.G)(),[b]=l.c.useForm(),_=(0,r.i6)(),q=(0,v.OY)(),{uuid:w}=(0,r.W4)(),{activeMenu:k}=(0,v.w1)((e=>e.menu),v.G),[S,F]=(0,s.useState)(!1),[L,N]=(0,s.useState)(null!==(t=k.data)&&void 0!==t&&t.logo_img?[null===(a=k.data)||void 0===a?void 0:a.logo_img]:[]),[H,D]=(0,s.useState)(null!==(d=k.data)&&void 0!==d&&d.background_img?[null===(c=k.data)||void 0===c?void 0:c.background_img]:[]),{settings:A}=(0,v.w1)((e=>e.globalSettings),v.G),[B,C]=(0,s.useState)(null!==k&&void 0!==k&&null!==(o=k.data)&&void 0!==o&&o.location?{lat:parseFloat(null===k||void 0===k||null===(u=k.data)||void 0===u||null===(m=u.location)||void 0===m?void 0:m.latitude),lng:parseFloat(null===k||void 0===k||null===(g=k.data)||void 0===g||null===(h=g.location)||void 0===h?void 0:h.longitude)}:(0,O.c)(A));(0,s.useEffect)((()=>()=>{const e=b.getFieldsValue(!0);e.open_time=JSON.stringify(null===e||void 0===e?void 0:e.open_time),e.close_time=JSON.stringify(null===e||void 0===e?void 0:e.close_time),q((0,G.MH)({activeMenu:k,data:{...k.data,...e}}))}),[]);return(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(l.c,{form:b,name:"basic",layout:"vertical",onFinish:e=>{var t,a,s;F(!0);const l={...e,"images[0]":null===(t=L[0])||void 0===t?void 0:t.name,"images[1]":null===(a=H[0])||void 0===a?void 0:a.name,delivery_time_type:e.delivery_time_type,delivery_time_to:e.delivery_time_to,delivery_time_from:e.delivery_time_from,categories:e.categories.map((e=>e.value)),tags:null===e||void 0===e||null===(s=e.tags)||void 0===s?void 0:s.map((e=>e.value)),user_id:e.user.value,open:void 0,"location[latitude]":B.lat,"location[longitude]":B.lng,user:void 0,delivery_time:0,type:"restaurant"};"edit"===p?function(e,t){Y.c.update(w,t).then((()=>{q((0,G.MH)({activeMenu:k,data:e})),x()})).catch((e=>console.error(e))).finally((()=>F(!1)))}(e,l):function(e,t){Y.c.create(t).then((t=>{let{data:a}=t;q((0,G.Ke)({id:"restaurant-".concat(a.uuid),url:"restaurant/".concat(a.uuid),name:y("add.restaurant"),data:{...a,background_img:{name:null===a||void 0===a?void 0:a.background_img},logo_img:{name:null===a||void 0===a?void 0:a.logo_img},...e},refetch:!1})),_("/restaurant/".concat(a.uuid,"?step=1"))})).catch((e=>console.error(e))).finally((()=>F(!1)))}(e,l)},initialValues:{open:!1,status:"new",...k.data},children:[(0,I.jsx)(M,{logoImage:L,setLogoImage:N,backImage:H,setBackImage:D,form:b,location:B,setLocation:C,user:j}),(0,I.jsx)(n.c,{children:(0,I.jsx)(i.c,{type:"primary",htmlType:"submit",loading:S,children:y("next")})})]})})}},58437:(e,t,a)=>{a.r(t),a.d(t,{default:()=>x,steps:()=>h});var s=a(99584),l=a(32712),n=a(424),i=a(65236),r=a(67692),d=a(68496),c=a(88276),o=a(90956),u=a(31864),m=a(97884);const{Step:g}=r.default,h=[{title:"restaurant",content:"First-content"},{title:"map",content:"Second-content"},{title:"delivery",content:"Third-content"}],x=()=>{var e;const{t:t}=(0,i.G)(),{activeMenu:a}=(0,l.w1)((e=>e.menu),l.G),[x,p]=(0,s.useState)((null===(e=a.data)||void 0===e?void 0:e.step)||0),j=()=>{p(x+1)},v=()=>{p(x-1)};return(0,m.jsxs)(d.default,{title:t("add.restaurant"),extra:(0,m.jsx)(n.c,{}),children:[(0,m.jsx)(r.default,{current:x,children:h.map((e=>(0,m.jsx)(g,{title:t(e.title)},e.title)))}),(0,m.jsxs)("div",{className:"steps-content",children:["First-content"===h[x].content&&(0,m.jsx)(c.c,{next:j,user:!1}),"Second-content"===h[x].content&&(0,m.jsx)(u.c,{next:j,prev:v}),"Third-content"===h[x].content&&(0,m.jsx)(o.c,{next:j,prev:v})]})]})}},90956:(e,t,a)=>{a.d(t,{c:()=>h});var s=a(65732),l=a(99584),n=a(77180),i=a(83072),r=a.n(i),d=a(94192),c=a(73259),o=a(23424),u=a(54112),m=a(75424),g=a(97884);const h=e=>{let{next:t,prev:a}=e;const[i]=s.c.useForm(),[h,x]=(0,l.useState)([]),[p,j]=(0,l.useState)(new Array(7).fill(!1)),[v,f]=(0,l.useState)(!1),[y,b]=(0,l.useState)(!1),{uuid:_}=(0,o.W4)();return(0,l.useEffect)((()=>{i.setFieldsValue({working_days:u.Q}),_&&(b(!0),c.c.getById(_).then((e=>{x(e.data.closed_dates.filter((e=>e.day>r()(new Date).format("YYYY-MM-DD"))).map((e=>new Date(e.day))))})),d.c.getById(_).then((e=>{j(0!==e.data.dates.length?e.data.dates.map((e=>e.disabled)):[]),0!==e.data.dates.length&&i.setFieldsValue({working_days:e.data.dates.map((e=>({title:e.day,from:r()(e.from,"HH:mm:ss"),to:r()(e.to,"HH:mm:ss"),disabled:Boolean(e.disabled)})))})})).finally((()=>b(!1))))}),[]),(0,g.jsx)(g.Fragment,{children:y?(0,g.jsx)(n.c,{}):(0,g.jsx)(m.c,{onFinish:e=>{f(!0);const a={dates:h?h.map((e=>r()(e).format("YYYY-MM-DD"))):void 0},s={dates:e.working_days.map((e=>({day:e.title,from:r()(e.from?e.from:"00").format("HH-mm"),to:r()(e.to?e.to:"00").format("HH-mm"),disabled:e.disabled})))};c.c.update(_,a).then((()=>{t()})).finally((()=>f(!1))),0!==e.working_days.length&&d.c.update(_,s).then((()=>{t()})).finally((()=>f(!1)))},prev:a,form:i,lines:p,loadingBtn:v,days:h,setDays:x,setLines:j,weeks:u.Q})})}}}]);